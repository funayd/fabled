var Kr=Object.defineProperty;var Ur=(i,e,t)=>e in i?Kr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var f=(i,e,t)=>Ur(i,typeof e!="symbol"?e+"":e,t);import{w as C,g as w,d as pe,c as ze,b as Je}from"./entry.j2XGvQNg.js";import{f as Di,g as Wr,i as Yr,a as lt,t as vt,e as qi,s as Vr}from"./disclose-version.B9aixzAF.js";import{b as mn,h as W,N as Dt,ae as zr,c as Yt,J as Jr,ar as gn,L as Hr,M as Fi,O as Ss,d as Ne,K as yn,a as ti,p as Qr,aB as _s,R as bn,G as Ms,aC as si,aD as Mi,aE as ii,aF as Gr,m as Xr,C as ji,aG as Zr,aq as wn,aH as eo,aI as kn,aJ as vn,ai as ni,an as to,aK as so,ah as Sn,ao as io,am as no,I as xi,aL as ro,aM as oo,aN as ao,E as lo,aO as co,aP as fo,P as uo,i as ho,aQ as po,aR as mo,n as Tt,aS as go,aT as yo,t as _n,aU as bo,Q as ri,F as wo,o as oi,g as rt,q as ko,v as Et,w as ai,x as ct,y as ft,z as ut,s as Ot,ay as As,aA as vo,at as So,au as _o,k as Ao}from"./runtime.LqzrUpiV.js";import{i as li}from"./lifecycle.CXak-Nyl.js";import{p as H,o as To,i as Ts,b as Eo,c as Oo}from"./index-client.no01Ekxd.js";let qt=null;function bc(i,e){return e}function No(i,e,t,s){for(var n=[],r=e.length,o=0;o<r;o++)Zr(e[o].e,n,!0);var a=r>0&&n.length===0&&t!==null;if(a){var l=t.parentNode;wn(l),l.append(t),s.clear(),ke(i,e[0].prev,e[r-1].next)}eo(n,()=>{for(var c=0;c<r;c++){var h=e[c];a||(s.delete(h.k),ke(i,h.prev,h.next)),kn(h.e,!a)}})}function wc(i,e,t,s,n,r=null){var o=i,a={flags:e,items:new Map,first:null},l=(e&vn)!==0;if(l){var c=i;o=W?Dt(ni(c)):c.appendChild(zr())}W&&Yt();var h=null,u=!1;mn(()=>{var d=t(),m=Jr(d)?d:d==null?[]:gn(d),y=m.length;if(u&&y===0)return;u=y===0;let p=!1;if(W){var g=o.data===Hr;g!==(y===0)&&(o=Fi(),Dt(o),Ss(!1),p=!0)}if(W){for(var k=null,b,v=0;v<y;v++){if(Ne.nodeType===8&&Ne.data===to){o=Ne,p=!0,Ss(!1);break}var _=m[v],T=s(_,v);b=An(Ne,a,k,null,_,T,v,n,e),a.items.set(T,b),k=b}y>0&&Dt(Fi())}W||Co(m,a,o,n,e,s),r!==null&&(y===0?h?yn(h):h=ti(()=>r(o)):h!==null&&Qr(h,()=>{h=null})),p&&Ss(!0),t()}),W&&(o=Ne)}function Co(i,e,t,s,n,r){var Ee,Bi,Ri,$i;var o=(n&so)!==0,a=(n&(si|ii))!==0,l=i.length,c=e.items,h=e.first,u=h,d,m=null,y,p=[],g=[],k,b,v,_;if(o)for(_=0;_<l;_+=1)k=i[_],b=r(k,_),v=c.get(b),v!==void 0&&((Ee=v.a)==null||Ee.measure(),(y??(y=new Set)).add(v));for(_=0;_<l;_+=1){if(k=i[_],b=r(k,_),v=c.get(b),v===void 0){var T=u?u.e.nodes_start:t;m=An(T,e,m,m===null?e.first:m.next,k,b,_,s,n),c.set(b,m),p=[],g=[],u=m.next;continue}if(a&&Io(v,k,_,n),v.e.f&_s&&(yn(v.e),o&&((Bi=v.a)==null||Bi.unfix(),(y??(y=new Set)).delete(v))),v!==u){if(d!==void 0&&d.has(v)){if(p.length<g.length){var S=g[0],E;m=S.prev;var A=p[0],B=p[p.length-1];for(E=0;E<p.length;E+=1)Ki(p[E],S,t);for(E=0;E<g.length;E+=1)d.delete(g[E]);ke(e,A.prev,B.next),ke(e,m,A),ke(e,B,S),u=S,m=B,_-=1,p=[],g=[]}else d.delete(v),Ki(v,u,t),ke(e,v.prev,v.next),ke(e,v,m===null?e.first:m.next),ke(e,m,v),m=v;continue}for(p=[],g=[];u!==null&&u.k!==b;)u.e.f&_s||(d??(d=new Set)).add(u),g.push(u),u=u.next;if(u===null)continue;v=u}p.push(v),m=v,u=v.next}if(u!==null||d!==void 0){for(var j=d===void 0?[]:gn(d);u!==null;)u.e.f&_s||j.push(u),u=u.next;var J=j.length;if(J>0){var I=n&vn&&l===0?t:null;if(o){for(_=0;_<J;_+=1)(Ri=j[_].a)==null||Ri.measure();for(_=0;_<J;_+=1)($i=j[_].a)==null||$i.fix()}No(e,j,I,c)}}o&&bn(()=>{var Pi;if(y!==void 0)for(v of y)(Pi=v.a)==null||Pi.apply()}),Ms.first=e.first&&e.first.e,Ms.last=m&&m.e}function Io(i,e,t,s){s&si&&Mi(i.v,e),s&ii?Mi(i.i,t):i.i=t}function An(i,e,t,s,n,r,o,a,l){var c=qt;try{var h=(l&si)!==0,u=(l&Gr)===0,d=h?u?Xr(n):ji(n):n,m=l&ii?ji(o):o,y={i:m,v:d,k:r,a:null,e:null,prev:t,next:s};return qt=y,y.e=ti(()=>a(i,d,m),W),y.e.prev=t&&t.e,y.e.next=s&&s.e,t===null?e.first=y:(t.next=y,t.e.next=y.e),s!==null&&(s.prev=y,s.e.prev=y.e),y}finally{qt=c}}function Ki(i,e,t){for(var s=i.next?i.next.e.nodes_start:t,n=e?e.e.nodes_start:t,r=i.e.nodes_start;r!==s;){var o=Sn(r);n.before(r),r=o}}function ke(i,e,t){e===null?i.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Lo(i,e,t,s,n){var r=i,o="",a;mn(()=>{if(o===(o=e()??"")){W&&Yt();return}a!==void 0&&(kn(a),a=void 0),o!==""&&(a=ti(()=>{if(W){Ne.data;for(var l=Yt(),c=l;l!==null&&(l.nodeType!==8||l.data!=="");)c=l,l=Sn(l);if(l===null)throw io(),no;Di(Ne,c),r=Dt(l);return}var h=o+"",u=Wr(h);Di(ni(u),u.lastChild),r.before(u)}))})}function Ui(i,e,t,s,n){var a;W&&Yt();var r=(a=e.$$slots)==null?void 0:a[t],o=!1;r===!0&&(r=e[t==="default"?"children":t],o=!0),r===void 0||r(i,o?()=>s:s)}function Bo(i){const e={};i.children&&(e.default=!0);for(const t in i.$$slots)e[t]=!0;return e}function kc(i){W&&ni(i)!==null&&wn(i)}let Wi=!1;function Tn(){Wi||(Wi=!0,document.addEventListener("reset",i=>{Promise.resolve().then(()=>{var e;if(!i.defaultPrevented)for(const t of i.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function js(i){if(W){var e=!1,t=()=>{if(!e){if(e=!0,i.hasAttribute("value")){var s=i.value;xs(i,"value",null),i.value=s}if(i.hasAttribute("checked")){var n=i.checked;xs(i,"checked",null),i.checked=n}}};i.__on_r=t,oo(t),Tn()}}function vc(i,e){var t=i.__attributes??(i.__attributes={});t.value===(t.value=e)||i.value===e||(i.value=e)}function xs(i,e,t,s){var n=i.__attributes??(i.__attributes={});W&&(n[e]=i.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&i.nodeName==="LINK")||n[e]!==(n[e]=t)&&(e==="loading"&&(i[ao]=t),t==null?i.removeAttribute(e):typeof t!="string"&&Ro(i).includes(e)?i[e]=t:i.setAttribute(e,t))}var Yi=new Map;function Ro(i){var e=Yi.get(i.nodeName);if(e)return e;Yi.set(i.nodeName,e=[]);for(var t,s=xi(i),n=Element.prototype;n!==s;){t=ro(s);for(var r in t)t[r].set&&e.push(r);s=xi(s)}return e}function Es(i,e,t){if(t){if(i.classList.contains(e))return;i.classList.add(e)}else{if(!i.classList.contains(e))return;i.classList.remove(e)}}const $o=requestAnimationFrame,Po=()=>performance.now(),ve={tick:i=>$o(i),now:()=>Po(),tasks:new Set};function En(i){ve.tasks.forEach(e=>{e.c(i)||(ve.tasks.delete(e),e.f())}),ve.tasks.size!==0&&ve.tick(En)}function Do(i){let e;return ve.tasks.size===0&&ve.tick(En),{promise:new Promise(t=>{ve.tasks.add(e={c:i,f:t})}),abort(){ve.tasks.delete(e)}}}function Nt(i,e){i.dispatchEvent(new CustomEvent(e))}function qo(i){const e=i.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(t=>t[0].toUpperCase()+t.slice(1)).join("")}function Vi(i){const e={},t=i.split(";");for(const s of t){const[n,r]=s.split(":");if(!n||r===void 0)break;const o=qo(n.trim());e[o]=r.trim()}return e}const Fo=i=>i;function Sc(i,e,t){var s=qt,n,r,o,a=null;s.a??(s.a={element:i,measure(){n=this.element.getBoundingClientRect()},apply(){if(o==null||o.abort(),r=this.element.getBoundingClientRect(),n.left!==r.left||n.right!==r.right||n.top!==r.top||n.bottom!==r.bottom){const l=e()(this.element,{from:n,to:r},t==null?void 0:t());o=Vt(this.element,l,void 0,1,()=>{o==null||o.abort(),o=void 0})}},fix(){if(!i.getAnimations().length){var{position:l,width:c,height:h}=getComputedStyle(i);if(l!=="absolute"&&l!=="fixed"){var u=i.style;a={position:u.position,width:u.width,height:u.height,transform:u.transform},u.position="absolute",u.width=c,u.height=h;var d=i.getBoundingClientRect();if(n.left!==d.left||n.top!==d.top){var m=`translate(${n.left-d.left}px, ${n.top-d.top}px)`;u.transform=u.transform?`${u.transform} ${m}`:m}}}},unfix(){if(a){var l=i.style;l.position=a.position,l.width=a.width,l.height=a.height,l.transform=a.transform}}}),s.a.element=i}function Oe(i,e,t,s){var n=(i&po)!==0,r=(i&go)!==0,o=n&&r,a=(i&yo)!==0,l=o?"both":n?"in":"out",c,h=e.inert,u,d;function m(){return c??(c=t()(e,(s==null?void 0:s())??{},{direction:l}))}var y={is_global:a,in(){var b;if(e.inert=h,!n){d==null||d.abort(),(b=d==null?void 0:d.reset)==null||b.call(d);return}r||u==null||u.abort(),Nt(e,"introstart"),u=Vt(e,m(),d,1,()=>{Nt(e,"introend"),u==null||u.abort(),u=c=void 0})},out(b){if(!r){b==null||b(),c=void 0;return}e.inert=!0,Nt(e,"outrostart"),d=Vt(e,m(),u,0,()=>{Nt(e,"outroend"),b==null||b()})},stop:()=>{u==null||u.abort(),d==null||d.abort()}},p=Ms;if((p.transitions??(p.transitions=[])).push(y),n&&Yr){var g=a;if(!g){for(var k=p.parent;k&&k.f&lo;)for(;(k=k.parent)&&!(k.f&co););g=!k||(k.f&fo)!==0}g&&uo(()=>{ho(()=>y.in())})}}function Vt(i,e,t,s,n){var r=s===1;if(mo(e)){var o,a=!1;return bn(()=>{if(!a){var g=e({direction:r?"in":"out"});o=Vt(i,g,t,s,n)}}),{abort:()=>{a=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(t==null||t.deactivate(),!(e!=null&&e.duration))return n(),{abort:Tt,deactivate:Tt,reset:Tt,t:()=>s};const{delay:l=0,css:c,tick:h,easing:u=Fo}=e;var d=[];if(r&&t===void 0&&(h&&h(0,1),c)){var m=Vi(c(0,1));d.push(m,m)}var y=()=>1-s,p=i.animate(d,{duration:l});return p.onfinish=()=>{var g=(t==null?void 0:t.t())??1-s;t==null||t.abort();var k=s-g,b=e.duration*Math.abs(k),v=[];if(b>0){if(c)for(var _=Math.ceil(b/16.666666666666668),T=0;T<=_;T+=1){var S=g+k*u(T/_),E=c(S,1-S);v.push(Vi(E))}y=()=>{var A=p.currentTime;return g+k*u(A/b)},h&&Do(()=>{if(p.playState!=="running")return!1;var A=y();return h(A,1-A),!0})}p=i.animate(v,{duration:b,fill:"forwards"}),p.onfinish=()=>{y=()=>s,h==null||h(s,1-s),n()}},{abort:()=>{p&&(p.cancel(),p.effect=null)},deactivate:()=>{n=Tt},reset:()=>{s===0&&(h==null||h(1,0))},t:()=>y()}}function _c(i,e,t,s=!0){s&&t();for(var n of e)i.addEventListener(n,t);_n(()=>{for(var r of e)i.removeEventListener(r,t)})}function ci(i,e,t,s=t){i.addEventListener(e,t);const n=i.__on_r;n?i.__on_r=()=>{n(),s()}:i.__on_r=s,Tn()}function Ks(i,e,t=e){var s=bo();ci(i,"input",()=>{var n=zi(i)?Ji(i.value):i.value;t(n),s&&n!==(n=e())&&(i.value=n??"")}),ri(()=>{var n=e();if(W&&i.defaultValue!==i.value){t(i.value);return}zi(i)&&n===Ji(i.value)||i.type==="date"&&!n&&!i.value||n!==i.value&&(i.value=n??"")})}function Ac(i,e,t=e){ci(i,"change",()=>{var s=i.checked;t(s)}),e()==null&&t(!1),ri(()=>{var s=e();i.checked=!!s})}function zi(i){var e=i.type;return e==="number"||e==="range"}function Ji(i){return i===""?null:+i}function Tc(i,e,t=e){ci(i,"change",()=>{t(i.files)}),ri(()=>{i.files=e()})}function Mo(i,e,t){var s=wo(i,e);s&&s.set&&(i[e]=t,_n(()=>{i[e]=null}))}const me=Object.create(null);me.open="0";me.close="1";me.ping="2";me.pong="3";me.message="4";me.upgrade="5";me.noop="6";const Ft=Object.create(null);Object.keys(me).forEach(i=>{Ft[me[i]]=i});const Us={type:"error",data:"parser error"},On=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Nn=typeof ArrayBuffer=="function",Cn=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,fi=({type:i,data:e},t,s)=>On&&e instanceof Blob?t?s(e):Hi(e,s):Nn&&(e instanceof ArrayBuffer||Cn(e))?t?s(e):Hi(new Blob([e]),s):s(me[i]+(e||"")),Hi=(i,e)=>{const t=new FileReader;return t.onload=function(){const s=t.result.split(",")[1];e("b"+(s||""))},t.readAsDataURL(i)};function Qi(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}let Os;function jo(i,e){if(On&&i.data instanceof Blob)return i.data.arrayBuffer().then(Qi).then(e);if(Nn&&(i.data instanceof ArrayBuffer||Cn(i.data)))return e(Qi(i.data));fi(i,!1,t=>{Os||(Os=new TextEncoder),e(Os.encode(t))})}const Gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<Gi.length;i++)ht[Gi.charCodeAt(i)]=i;const xo=i=>{let e=i.length*.75,t=i.length,s,n=0,r,o,a,l;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);const c=new ArrayBuffer(e),h=new Uint8Array(c);for(s=0;s<t;s+=4)r=ht[i.charCodeAt(s)],o=ht[i.charCodeAt(s+1)],a=ht[i.charCodeAt(s+2)],l=ht[i.charCodeAt(s+3)],h[n++]=r<<2|o>>4,h[n++]=(o&15)<<4|a>>2,h[n++]=(a&3)<<6|l&63;return c},Ko=typeof ArrayBuffer=="function",ui=(i,e)=>{if(typeof i!="string")return{type:"message",data:In(i,e)};const t=i.charAt(0);return t==="b"?{type:"message",data:Uo(i.substring(1),e)}:Ft[t]?i.length>1?{type:Ft[t],data:i.substring(1)}:{type:Ft[t]}:Us},Uo=(i,e)=>{if(Ko){const t=xo(i);return In(t,e)}else return{base64:!0,data:i}},In=(i,e)=>{switch(e){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}},Ln="",Wo=(i,e)=>{const t=i.length,s=new Array(t);let n=0;i.forEach((r,o)=>{fi(r,!1,a=>{s[o]=a,++n===t&&e(s.join(Ln))})})},Yo=(i,e)=>{const t=i.split(Ln),s=[];for(let n=0;n<t.length;n++){const r=ui(t[n],e);if(s.push(r),r.type==="error")break}return s};function Vo(){return new TransformStream({transform(i,e){jo(i,t=>{const s=t.length;let n;if(s<126)n=new Uint8Array(1),new DataView(n.buffer).setUint8(0,s);else if(s<65536){n=new Uint8Array(3);const r=new DataView(n.buffer);r.setUint8(0,126),r.setUint16(1,s)}else{n=new Uint8Array(9);const r=new DataView(n.buffer);r.setUint8(0,127),r.setBigUint64(1,BigInt(s))}i.data&&typeof i.data!="string"&&(n[0]|=128),e.enqueue(n),e.enqueue(t)})}})}let Ns;function Ct(i){return i.reduce((e,t)=>e+t.length,0)}function It(i,e){if(i[0].length===e)return i.shift();const t=new Uint8Array(e);let s=0;for(let n=0;n<e;n++)t[n]=i[0][s++],s===i[0].length&&(i.shift(),s=0);return i.length&&s<i[0].length&&(i[0]=i[0].slice(s)),t}function zo(i,e){Ns||(Ns=new TextDecoder);const t=[];let s=0,n=-1,r=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(s===0){if(Ct(t)<1)break;const l=It(t,1);r=(l[0]&128)===128,n=l[0]&127,n<126?s=3:n===126?s=1:s=2}else if(s===1){if(Ct(t)<2)break;const l=It(t,2);n=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),s=3}else if(s===2){if(Ct(t)<8)break;const l=It(t,8),c=new DataView(l.buffer,l.byteOffset,l.length),h=c.getUint32(0);if(h>Math.pow(2,21)-1){a.enqueue(Us);break}n=h*Math.pow(2,32)+c.getUint32(4),s=3}else{if(Ct(t)<n)break;const l=It(t,n);a.enqueue(ui(r?l:Ns.decode(l),e)),s=0}if(n===0||n>i){a.enqueue(Us);break}}}})}const Bn=4;function q(i){if(i)return Jo(i)}function Jo(i){for(var e in q.prototype)i[e]=q.prototype[e];return i}q.prototype.on=q.prototype.addEventListener=function(i,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(e),this};q.prototype.once=function(i,e){function t(){this.off(i,t),e.apply(this,arguments)}return t.fn=e,this.on(i,t),this};q.prototype.off=q.prototype.removeListener=q.prototype.removeAllListeners=q.prototype.removeEventListener=function(i,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+i];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var s,n=0;n<t.length;n++)if(s=t[n],s===e||s.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+i],this};q.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+i],s=1;s<arguments.length;s++)e[s-1]=arguments[s];if(t){t=t.slice(0);for(var s=0,n=t.length;s<n;++s)t[s].apply(this,e)}return this};q.prototype.emitReserved=q.prototype.emit;q.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};q.prototype.hasListeners=function(i){return!!this.listeners(i).length};const ns=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Q=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Ho="arraybuffer";function Rn(i,...e){return e.reduce((t,s)=>(i.hasOwnProperty(s)&&(t[s]=i[s]),t),{})}const Qo=Q.setTimeout,Go=Q.clearTimeout;function rs(i,e){e.useNativeTimers?(i.setTimeoutFn=Qo.bind(Q),i.clearTimeoutFn=Go.bind(Q)):(i.setTimeoutFn=Q.setTimeout.bind(Q),i.clearTimeoutFn=Q.clearTimeout.bind(Q))}const Xo=1.33;function Zo(i){return typeof i=="string"?ea(i):Math.ceil((i.byteLength||i.size)*Xo)}function ea(i){let e=0,t=0;for(let s=0,n=i.length;s<n;s++)e=i.charCodeAt(s),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(s++,t+=4);return t}function $n(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ta(i){let e="";for(let t in i)i.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(i[t]));return e}function sa(i){let e={},t=i.split("&");for(let s=0,n=t.length;s<n;s++){let r=t[s].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}class ia extends Error{constructor(e,t,s){super(e),this.description=t,this.context=s,this.type="TransportError"}}class hi extends q{constructor(e){super(),this.writable=!1,rs(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,s){return super.emitReserved("error",new ia(e,t,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ui(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=ta(e);return t.length?"?"+t:""}}class na extends hi{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||t()})),this.writable||(s++,this.once("drain",function(){--s||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};Yo(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Wo(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=$n()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Pn=!1;try{Pn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ra=Pn;function oa(){}class aa extends na{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let s=location.port;s||(s=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||s!==e.port}}doWrite(e,t){const s=this.request({method:"POST",data:e});s.on("success",t),s.on("error",(n,r)=>{this.onError("xhr post error",n,r)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,s)=>{this.onError("xhr poll error",t,s)}),this.pollXhr=e}}class he extends q{constructor(e,t,s){super(),this.createRequest=e,rs(this,s),this._opts=s,this._method=s.method||"GET",this._uri=t,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var e;const t=Rn(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(t);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let n in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(n)&&s.setRequestHeader(n,this._opts.extraHeaders[n])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var n;s.readyState===3&&((n=this._opts.cookieJar)===null||n===void 0||n.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(n){this.setTimeoutFn(()=>{this._onError(n)},0);return}typeof document<"u"&&(this._index=he.requestsCount++,he.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=oa,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete he.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}he.requestsCount=0;he.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Xi);else if(typeof addEventListener=="function"){const i="onpagehide"in Q?"pagehide":"unload";addEventListener(i,Xi,!1)}}function Xi(){for(let i in he.requests)he.requests.hasOwnProperty(i)&&he.requests[i].abort()}const la=function(){const i=Dn({xdomain:!1});return i&&i.responseType!==null}();class ca extends aa{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=la&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new he(Dn,this.uri(),e)}}function Dn(i){const e=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ra))return new XMLHttpRequest}catch{}if(!e)try{return new Q[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const qn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class fa extends hi{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,s=qn?{}:Rn(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,s)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],n=t===e.length-1;fi(s,this.supportsBinary,r=>{try{this.doWrite(s,r)}catch{}n&&ns(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=$n()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Cs=Q.WebSocket||Q.MozWebSocket;class ua extends fa{createSocket(e,t,s){return qn?new Cs(e,t,s):t?new Cs(e,t):new Cs(e)}doWrite(e,t){this.ws.send(t)}}class ha extends hi{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=zo(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=e.readable.pipeThrough(t).getReader(),n=Vo();n.readable.pipeTo(e.writable),this._writer=n.writable.getWriter();const r=()=>{s.read().then(({done:a,value:l})=>{a||(this.onPacket(l),r())}).catch(a=>{})};r();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const s=e[t],n=t===e.length-1;this._writer.write(s).then(()=>{n&&ns(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const da={websocket:ua,webtransport:ha,polling:ca},pa=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ma=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Ws(i){if(i.length>8e3)throw"URI too long";const e=i,t=i.indexOf("["),s=i.indexOf("]");t!=-1&&s!=-1&&(i=i.substring(0,t)+i.substring(t,s).replace(/:/g,";")+i.substring(s,i.length));let n=pa.exec(i||""),r={},o=14;for(;o--;)r[ma[o]]=n[o]||"";return t!=-1&&s!=-1&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=ga(r,r.path),r.queryKey=ya(r,r.query),r}function ga(i,e){const t=/\/{2,9}/g,s=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&s.splice(0,1),e.slice(-1)=="/"&&s.splice(s.length-1,1),s}function ya(i,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,n,r){n&&(t[n]=r)}),t}const Ys=typeof addEventListener=="function"&&typeof removeEventListener=="function",Mt=[];Ys&&addEventListener("offline",()=>{Mt.forEach(i=>i())},!1);class Se extends q{constructor(e,t){if(super(),this.binaryType=Ho,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const s=Ws(e);t.hostname=s.host,t.secure=s.protocol==="https"||s.protocol==="wss",t.port=s.port,s.query&&(t.query=s.query)}else t.host&&(t.hostname=Ws(t.host).host);rs(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(s=>{const n=s.prototype.name;this.transports.push(n),this._transportsByName[n]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=sa(this.opts.query)),Ys&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Mt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Bn,t.transport=e,this.id&&(t.sid=this.id);const s=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Se.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Se.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let s=0;s<this.writeBuffer.length;s++){const n=this.writeBuffer[s].data;if(n&&(t+=Zo(n)),s>0&&t>this._maxPayload)return this.writeBuffer.slice(0,s);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,ns(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,s){return this._sendPacket("message",e,t,s),this}send(e,t,s){return this._sendPacket("message",e,t,s),this}_sendPacket(e,t,s,n){if(typeof t=="function"&&(n=t,t=void 0),typeof s=="function"&&(n=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const r={type:e,data:t,options:s};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},s=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():e()}):this.upgrading?s():e()),this}_onError(e){if(Se.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ys&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Mt.indexOf(this._offlineEventListener);s!==-1&&Mt.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Se.protocol=Bn;class ba extends Se{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),s=!1;Se.priorWebsocketSuccess=!1;const n=()=>{s||(t.send([{type:"ping",data:"probe"}]),t.once("packet",u=>{if(!s)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Se.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(h(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const d=new Error("probe error");d.transport=t.name,this.emitReserved("upgradeError",d)}}))};function r(){s||(s=!0,h(),t.close(),t=null)}const o=u=>{const d=new Error("probe error: "+u);d.transport=t.name,r(),this.emitReserved("upgradeError",d)};function a(){o("transport closed")}function l(){o("socket closed")}function c(u){t&&u.name!==t.name&&r()}const h=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",c)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{s||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let s=0;s<e.length;s++)~this.transports.indexOf(e[s])&&t.push(e[s]);return t}}let wa=class extends ba{constructor(e,t={}){const s=typeof e=="object"?e:t;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(n=>da[n]).filter(n=>!!n)),super(e,s)}};function ka(i,e="",t){let s=i;t=t||typeof location<"u"&&location,i==null&&(i=t.protocol+"//"+t.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=t.protocol+i:i=t.host+i),/^(https?|wss?):\/\//.test(i)||(typeof t<"u"?i=t.protocol+"//"+i:i="https://"+i),s=Ws(i)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const r=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+r+":"+s.port+e,s.href=s.protocol+"://"+r+(t&&t.port===s.port?"":":"+s.port),s}const va=typeof ArrayBuffer=="function",Sa=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,Fn=Object.prototype.toString,_a=typeof Blob=="function"||typeof Blob<"u"&&Fn.call(Blob)==="[object BlobConstructor]",Aa=typeof File=="function"||typeof File<"u"&&Fn.call(File)==="[object FileConstructor]";function di(i){return va&&(i instanceof ArrayBuffer||Sa(i))||_a&&i instanceof Blob||Aa&&i instanceof File}function jt(i,e){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let t=0,s=i.length;t<s;t++)if(jt(i[t]))return!0;return!1}if(di(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return jt(i.toJSON(),!0);for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&jt(i[t]))return!0;return!1}function Ta(i){const e=[],t=i.data,s=i;return s.data=Vs(t,e),s.attachments=e.length,{packet:s,buffers:e}}function Vs(i,e){if(!i)return i;if(di(i)){const t={_placeholder:!0,num:e.length};return e.push(i),t}else if(Array.isArray(i)){const t=new Array(i.length);for(let s=0;s<i.length;s++)t[s]=Vs(i[s],e);return t}else if(typeof i=="object"&&!(i instanceof Date)){const t={};for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=Vs(i[s],e));return t}return i}function Ea(i,e){return i.data=zs(i.data,e),delete i.attachments,i}function zs(i,e){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<e.length)return e[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let t=0;t<i.length;t++)i[t]=zs(i[t],e);else if(typeof i=="object")for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=zs(i[t],e));return i}const Oa=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Na=5;var N;(function(i){i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK"})(N||(N={}));class Ca{constructor(e){this.replacer=e}encode(e){return(e.type===N.EVENT||e.type===N.ACK)&&jt(e)?this.encodeAsBinary({type:e.type===N.EVENT?N.BINARY_EVENT:N.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===N.BINARY_EVENT||e.type===N.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=Ta(e),s=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(s),n}}function Zi(i){return Object.prototype.toString.call(i)==="[object Object]"}class pi extends q{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const s=t.type===N.BINARY_EVENT;s||t.type===N.BINARY_ACK?(t.type=s?N.EVENT:N.ACK,this.reconstructor=new Ia(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(di(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const s={type:Number(e.charAt(0))};if(N[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===N.BINARY_EVENT||s.type===N.BINARY_ACK){const r=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(r,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(e.charAt(t+1)==="/"){const r=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););s.nsp=e.substring(r,t)}else s.nsp="/";const n=e.charAt(t+1);if(n!==""&&Number(n)==n){const r=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}s.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(pi.isPayloadValid(s.type,r))s.data=r;else throw new Error("invalid payload")}return s}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case N.CONNECT:return Zi(t);case N.DISCONNECT:return t===void 0;case N.CONNECT_ERROR:return typeof t=="string"||Zi(t);case N.EVENT:case N.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&Oa.indexOf(t[0])===-1);case N.ACK:case N.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ia{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Ea(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const La=Object.freeze(Object.defineProperty({__proto__:null,Decoder:pi,Encoder:Ca,get PacketType(){return N},protocol:Na},Symbol.toStringTag,{value:"Module"}));function ae(i,e,t){return i.on(e,t),function(){i.off(e,t)}}const Ba=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Mn extends q{constructor(e,t,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ae(e,"open",this.onopen.bind(this)),ae(e,"packet",this.onpacket.bind(this)),ae(e,"error",this.onerror.bind(this)),ae(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var s,n,r;if(Ba.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:N.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const h=this.ids++,u=t.pop();this._registerAckCallback(h,u),o.id=h}const a=(n=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||n===void 0?void 0:n.writable,l=this.connected&&!(!((r=this.io.engine)===null||r===void 0)&&r._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var s;const n=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(n===void 0){this.acks[e]=t;return}const r=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},n),o=(...a)=>{this.io.clearTimeoutFn(r),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((s,n)=>{const r=(o,a)=>o?n(o):s(a);r.withError=!0,t.push(r),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((n,...r)=>s!==this._queue[0]?void 0:(n!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(n)):(this._queue.shift(),t&&t(null,...r)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:N.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(s=>String(s.id)===e)){const s=this.acks[e];delete this.acks[e],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case N.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case N.EVENT:case N.BINARY_EVENT:this.onevent(e);break;case N.ACK:case N.BINARY_ACK:this.onack(e);break;case N.DISCONNECT:this.ondisconnect();break;case N.CONNECT_ERROR:this.destroy();const s=new Error(e.data.message);s.data=e.data.data,this.emitReserved("connect_error",s);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const s of t)s.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let s=!1;return function(...n){s||(s=!0,t.packet({type:N.ACK,id:e,data:n}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:N.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let s=0;s<t.length;s++)if(e===t[s])return t.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const s of t)s.apply(this,e.data)}}}function Ge(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}Ge.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*i);i=Math.floor(e*10)&1?i+t:i-t}return Math.min(i,this.max)|0};Ge.prototype.reset=function(){this.attempts=0};Ge.prototype.setMin=function(i){this.ms=i};Ge.prototype.setMax=function(i){this.max=i};Ge.prototype.setJitter=function(i){this.jitter=i};class Js extends q{constructor(e,t){var s;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,rs(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((s=t.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Ge({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||La;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new wa(this.uri,this.opts);const t=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const n=ae(t,"open",function(){s.onopen(),e&&e()}),r=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=ae(t,"error",r);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{n(),r(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(n),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ae(e,"ping",this.onping.bind(this)),ae(e,"data",this.ondata.bind(this)),ae(e,"error",this.onerror.bind(this)),ae(e,"close",this.onclose.bind(this)),ae(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){ns(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let s=this.nsps[e];return s?this._autoConnect&&!s.active&&s.connect():(s=new Mn(this,e,t),this.nsps[e]=s),s}_destroy(e){const t=Object.keys(this.nsps);for(const s of t)if(this.nsps[s].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let s=0;s<t.length;s++)this.engine.write(t[s],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):e.onreconnect()}))},t);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const ot={};function Is(i,e){typeof i=="object"&&(e=i,i=void 0),e=e||{};const t=ka(i,e.path||"/socket.io"),s=t.source,n=t.id,r=t.path,o=ot[n]&&r in ot[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new Js(s,e):(ot[n]||(ot[n]=new Js(s,e)),l=ot[n]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(Is,{Manager:Js,Socket:Mn,io:Is,connect:Is});const Oc=(()=>{let i=!0;{const n=localStorage.getItem("show-summary-items");i=n!==null?n==="true":i}const{subscribe:e,set:t,update:s}=C(i);return{subscribe:e,set:n=>(localStorage.setItem("show-summary-items",String(n)),t(n)),update:s}})(),Nc=(()=>{let i=!0;i=localStorage.getItem("use-symbols")==="true";const{subscribe:e,set:t,update:s}=C(i);return{subscribe:e,set:n=>(localStorage.setItem("use-symbols",String(n)),t(n)),update:s}})(),Cc=(()=>{let i=!0;{const n=localStorage.getItem("animation-enabled");i=n!==null?n==="true":i}const{subscribe:e,set:t,update:s}=C(i);return{subscribe:e,set:n=>(localStorage.setItem("animation-enabled",String(n)),t(n)),update:s}})(),Ic=C(!1),te=C(!1),Ls=C(-1);class Ra{constructor(){f(this,"socket");f(this,"sessionId","");f(this,"clientId","");f(this,"serverId","");f(this,"dcTimeout",4*60*1e3);f(this,"_dcTask",null);f(this,"_dcWarningTask",null);f(this,"_onConnect",[]);f(this,"_onDisconnect",[]);f(this,"keyphrase",C(""));this.socket=null}onConnect(e){this._onConnect.includes(e)||this._onConnect.push(e)}offConnect(e){this._onConnect=this._onConnect.filter(t=>t!==e)}clearOnConnect(){this._onConnect=[]}onDisconnect(e){this._onDisconnect.includes(e)||this._onDisconnect.push(e)}offDisconnect(e){this._onDisconnect=this._onDisconnect.filter(t=>t!==e)}clearOnDisconnect(){this._onDisconnect=[]}connect(e,t=void 0){return null}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}resetTimeout(){this._dcTask&&window.clearTimeout(this._dcTask),this._dcWarningTask&&window.clearTimeout(this._dcWarningTask),Ls.set(-1),this.dcTimeout>=6e4?this._dcWarningTask=window.setTimeout(()=>Ls.set(60),this.dcTimeout-6e4):this.dcTimeout>=1e3&&Ls.set(this.dcTimeout/1e3),this._dcTask=window.setTimeout(()=>{var e;return(e=this.socket)==null?void 0:e.disconnect()},this.dcTimeout)}ping(){this.socket&&(this.socket.emit("ping",{to:this.serverId}),this.resetTimeout())}emit(e,t){!this.socket||!w(te)||(this.socket.emit(e,t),this.resetTimeout())}reloadSapi(){return new Promise((e,t)=>{if(!this.socket||!w(te)){t("No socket");return}this.socket.timeout(1e4).emitWithAck("reload",{to:this.serverId}).then(s=>{s[0]===!0?(e(!0),this.resetTimeout()):t(s[0])}).catch(s=>t(s))})}getClasses(){return!this.socket||!w(te)?Promise.reject("No socket"):(this.socket.emit("getClasses",{to:this.serverId}),new Promise((e,t)=>{var s;(s=this.socket)==null||s.on("classes",({content:n})=>{var r;(r=this.socket)==null||r.off("classes"),typeof n=="string"&&(n=[n]),e(n)}),setTimeout(()=>t("Timeout"),3e3)}))}getSkills(){return!this.socket||!w(te)?Promise.reject("No socket"):(this.socket.emit("getSkills",{to:this.serverId}),new Promise((e,t)=>{var s;(s=this.socket)==null||s.on("skills",({content:n})=>{var r;(r=this.socket)==null||r.off("skills"),typeof n=="string"&&(n=[n]),e(n)}),setTimeout(()=>t("Timeout"),3e3)}))}getClassYaml(e){return!this.socket||!w(te)?Promise.reject("No socket"):(this.socket.emit("getClassYaml",{name:e,to:this.serverId}),new Promise((t,s)=>{var n;(n=this.socket)==null||n.on("classYaml",({content:r})=>{var o;(o=this.socket)==null||o.off("classYaml"),t(r)}),setTimeout(()=>s("Timeout"),3e3)}))}getSkillYaml(e){return!this.socket||!w(te)?Promise.reject("No socket"):(this.socket.emit("getSkillYaml",{name:e,to:this.serverId}),new Promise((t,s)=>{var n;(n=this.socket)==null||n.on("skillYaml",({content:r})=>{var o;(o=this.socket)==null||o.off("skillYaml"),t(r)}),setTimeout(()=>s("Timeout"),3e3)}))}getAttributeYaml(){return!this.socket||!w(te)?Promise.reject("No socket"):(this.socket.emit("getAttributeYaml",{to:this.serverId}),new Promise((e,t)=>{var s;(s=this.socket)==null||s.on("attributeYaml",({content:n})=>{var r;(r=this.socket)==null||r.off("attributeYaml"),e(n)}),setTimeout(()=>t("Timeout"),3e3)}))}async saveSkillToServer(e,t){if(!this.socket||!w(te))return Promise.reject("No socket");try{const s=await this.socket.timeout(3e3).emitWithAck("saveSkill",{name:e,yaml:t,to:this.serverId}),n=s&&s[0]===e;return n||console.log("Error saving skill",s),this.resetTimeout(),n}catch(s){return console.log("Timeout saving skill to server",s),!1}}async saveClassToServer(e,t){if(!this.socket||!w(te))return Promise.reject("No socket");try{const s=await this.socket.timeout(3e3).emitWithAck("saveClass",{name:e,yaml:t,to:this.serverId}),n=s&&s[0]===e;return n||console.log("Error saving class",s),this.resetTimeout(),n}catch(s){return console.log("Timeout saving class to server",s),!1}}async saveAttributesToServer(e){if(!this.socket||!w(te))return console.log("socket not connected"),Promise.reject("No socket");try{const t=await this.socket.timeout(3e3).emitWithAck("saveAttributes",{yaml:e,to:this.serverId}),s=t&&t[0]==="attributes";return s||console.log("Error saving attribute",t),this.resetTimeout(),s}catch(t){return console.log("Timeout saving attribute to server",t),!1}}async exportAll(e,t,s){if(!this.socket||!w(te))return Promise.reject("No socket");try{const n=await this.socket.timeout(4500).emitWithAck("exportAll",{to:this.serverId,classYaml:e,skillYaml:t,attributeYaml:s});return n&&n[0]?!!n[0]:(this.resetTimeout(),console.log("Error exporting all",n),!1)}catch(n){return console.log("Timeout exporting all",n),!1}}}const U=new Ra;class jn{}f(jn,"new",()=>{throw new Error("'new' method not implemented")});class $a extends jn{constructor(t,s,n=!1){super();f(this,"type");f(this,"name");f(this,"description");f(this,"comment");f(this,"components",C([]));f(this,"data",[]);f(this,"preview",[]);f(this,"enablePreview",!1);f(this,"summaryItems",[]);f(this,"isParent",!0);f(this,"isDeprecated",!1);f(this,"id",{});f(this,"_defaultOpen",!1);f(this,"parent");f(this,"setComponents",t=>{t.forEach(s=>s.parent=this),this.components.set([...t])});f(this,"contains",t=>{const s=w(this.components);if(s.includes(t))return!0;for(const n of s)if(n.contains(t))return!0;return!1});f(this,"addComponent",(t,s=-1)=>{const n=w(this.components);s==-1?n.push(t):n.splice(s,0,t),this.setComponents(n)});f(this,"removeComponent",t=>{const s=w(this.components);if(s.includes(t)){s.splice(s.indexOf(t),1),t.parent=void 0,this.setComponents(s);return}for(const n of s)n.contains(t)&&n.removeComponent(t)});f(this,"defaultOpen",()=>(this._defaultOpen=!0,this));f(this,"nextChar",t=>/z$/.test(t)?t.replaceAll(/z$/g,"a")+"a":t.substring(0,t.length-1)+String.fromCharCode(t.charCodeAt(t.length-1)+1));this.type=t,this.name=s.name,this.description=s.description??"",this.summaryItems=s.summaryItems??[],this.comment=s.comment??"",this.setComponents(s.components||[]),this.data=s.data||[],this.preview=s.preview||[],this.isDeprecated=n}getValue(t){var n;const s=(n=this.data)==null?void 0:n.find(r=>r.key==t);return!s||!s.meetsRequirements(this)?"":s.getSummary()}toYamlObj(){const t={type:this.type,comment:this.comment};if(this.preview.length>0){const n={enabled:this.enablePreview};this.preview.filter(r=>r.meetsPreviewRequirements(this)).forEach(r=>{const o=r.getData();Object.keys(o).forEach(a=>n[a]=o[a])}),t.preview=n}const s=this.getData();if(Object.keys(s).length>0&&(t.data=s),this.isParent){const n=w(this.components);if(n.length>0){const r={};n.forEach(o=>{const a=o.toYamlObj();let l=o.name,c="a";for(;r[l];)c=this.nextChar(c),l=o.name+"-"+c;r[l]=a}),t.children=r}}return t}getRawPreviewData(){const t={};return this.preview.forEach(s=>{const n=s.getData();Object.keys(n).forEach(r=>t[r]=n[r])}),t}deserialize(t){const s=t.preview;s&&(this.enablePreview=s.enabled,this.preview.forEach(n=>n.deserialize(s))),t.comment&&(this.comment=t.comment.replaceAll("\\n",`
`))}}const xn=C({}),zt=C({}),Jt=C({}),Ht=C({}),Kn=C(!1),os=C(""),Pa=pe([xn,os],([i,e])=>Object.keys(i).filter(s=>s.toLowerCase().replace("_"," ").includes(e.toLowerCase())).sort((s,n)=>(i[s].component.new().isDeprecated?0:-1)-(i[n].component.new().isDeprecated?0:-1)).map(s=>i[s])),Lc=pe(Pa,i=>{const e={};return i.forEach(t=>{let s="General";t.section&&(s=t.section),e[s]||(e[s]=[]),e[s].push(t)}),e}),Bc=pe([zt,os],([i,e])=>Object.keys(i).filter(s=>s.toLowerCase().replace("_"," ").includes(e.toLowerCase())).sort((s,n)=>(i[s].component.new().isDeprecated?0:-1)-(i[n].component.new().isDeprecated?0:-1)).map(s=>i[s])),Rc=pe([Jt,os],([i,e])=>Object.keys(i).filter(s=>s.toLowerCase().replace("_"," ").includes(e.toLowerCase())).sort((s,n)=>(i[s].component.new().isDeprecated?0:-1)-(i[n].component.new().isDeprecated?0:-1)).map(s=>i[s])),Da=pe([Ht,os],([i,e])=>Object.keys(i).filter(s=>s.toLowerCase().replace("_"," ").includes(e.toLowerCase())).sort((s,n)=>(i[s].component.new().isDeprecated?0:-1)-(i[n].component.new().isDeprecated?0:-1)).map(s=>i[s])),$c=pe(Da,i=>{const e={};return i.forEach(t=>{let s="General";t.section&&(s=t.section),e[s]||(e[s]=[]),e[s].push(t)}),e}),ne=class ne{};f(ne,"getTriggerByName",e=>{var s;return(s=Object.values(w(xn)).find(n=>{var r;return n.name.toLowerCase()===e.toLowerCase()||((r=n.alias)==null?void 0:r.toLowerCase())===e.toLowerCase()}))==null?void 0:s.component}),f(ne,"getTargetByName",e=>{var s;return(s=Object.values(w(zt)).find(n=>{var r;return n.name.toLowerCase()===e.toLowerCase()||((r=n.alias)==null?void 0:r.toLowerCase())===e.toLowerCase()}))==null?void 0:s.component}),f(ne,"getConditionByName",e=>{var s;return(s=Object.values(w(Jt)).find(n=>{var r;return n.name.toLowerCase()===e.toLowerCase()||((r=n.alias)==null?void 0:r.toLowerCase())===e.toLowerCase()}))==null?void 0:s.component}),f(ne,"getMechanicByName",e=>{var s;return(s=Object.values(w(Ht)).find(n=>{var r;return n.name.toLowerCase()===e.toLowerCase()||((r=n.alias)==null?void 0:r.toLowerCase())===e.toLowerCase()}))==null?void 0:s.component}),f(ne,"deserializeComponents",e=>{if(!e)return[];const t=[],s=Object.keys(e);for(const n of s){let r;const o=e[n],a=o.type;if(a==="trigger"){const l=ne.getTriggerByName(n.split("-")[0]);l&&(r=l.new())}else if(a==="target"){const l=ne.getTargetByName(n.split("-")[0]);l&&(r=l.new())}else if(a==="condition"){const l=ne.getConditionByName(n.split("-")[0]);l&&(r=l.new())}else if(a==="mechanic"){const l=ne.getMechanicByName(n.split("-")[0]);l&&(r=l.new())}r&&(r.deserialize(o),t.push(r))}return t});let gt=ne;const qa=i=>i;function Un(i){const e=i-1;return e*e*e+1}function en(i){const e=typeof i=="string"&&i.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[i,"px"]}function Pc(i,{delay:e=0,duration:t=400,easing:s=qa}={}){const n=+getComputedStyle(i).opacity;return{delay:e,duration:t,easing:s,css:r=>`opacity: ${r*n}`}}function Fa(i,{delay:e=0,duration:t=400,easing:s=Un,x:n=0,y:r=0,opacity:o=0}={}){const a=getComputedStyle(i),l=+a.opacity,c=a.transform==="none"?"":a.transform,h=l*(1-o),[u,d]=en(n),[m,y]=en(r);return{delay:e,duration:t,easing:s,css:(p,g)=>`
			transform: ${c} translate(${(1-p)*u}${d}, ${(1-p)*m}${y});
			opacity: ${l-h*g}`}}function De(i,{delay:e=0,duration:t=400,easing:s=Un,axis:n="y"}={}){const r=getComputedStyle(i),o=+r.opacity,a=n==="y"?"height":"width",l=parseFloat(r[a]),c=n==="y"?["top","bottom"]:["left","right"],h=c.map(k=>`${k[0].toUpperCase()}${k.slice(1)}`),u=parseFloat(r[`padding${h[0]}`]),d=parseFloat(r[`padding${h[1]}`]),m=parseFloat(r[`margin${h[0]}`]),y=parseFloat(r[`margin${h[1]}`]),p=parseFloat(r[`border${h[0]}Width`]),g=parseFloat(r[`border${h[1]}Width`]);return{delay:e,duration:t,easing:s,css:k=>`overflow: hidden;opacity: ${Math.min(k*20,1)*o};${a}: ${k*l}px;padding-${c[0]}: ${k*u}px;padding-${c[1]}: ${k*d}px;margin-${c[0]}: ${k*m}px;margin-${c[1]}: ${k*y}px;border-${c[0]}-width: ${k*p}px;border-${c[1]}-width: ${k*g}px;`}}const Ma=i=>i.replace("_"," ").toLowerCase().replace(/^(.)|\s(.)/g,e=>e.toUpperCase()),Wn=i=>(i=i.replace("_"," "),i.substring(0,1).toUpperCase()+i.substring(1).toLowerCase()),G=i=>i.sort((e,t)=>e.name.localeCompare(t.name)),ja=(i,e)=>{let t=e;localStorage.getItem(i)===null&&(typeof e=="string"||typeof e=="number"||typeof e=="boolean"?localStorage.setItem(i,e.toString()):localStorage.setItem(i,JSON.stringify(e))),typeof e=="number"?t=parseInt(localStorage.getItem(i)):typeof e=="boolean"?t=localStorage.getItem(i)==="true":typeof e=="string"?t=localStorage.getItem(i):t=JSON.parse(localStorage.getItem(i));const{subscribe:s,set:n,update:r}=C(t);return{subscribe:s,set:o=>(typeof o=="string"||typeof o=="number"||typeof o=="boolean"?localStorage.setItem(i,o.toString()):localStorage.setItem(i,JSON.stringify(o)),n(o)),update:r}},ie=i=>typeof i=="boolean"?i:i==="true";var xa=vt('<div class="tooltip svelte-1aj70cs"><!></div>'),Ka=vt('<div class="label svelte-1aj70cs"><!> <span class="display svelte-1aj70cs" role="definition"> <!></span></div>'),Ua=vt('<input class="svelte-1aj70cs">'),Wa=vt('<!> <div class="input-wrapper"><!> <!></div>',1);function Ya(i,e){const t=Bo(e);oi(e,!1);let s=H(e,"tooltip",8,void 0),n=H(e,"label",8,void 0),r=H(e,"value",12,void 0),o=H(e,"placeholder",8,void 0),a=H(e,"nowrap",8,!1),l=H(e,"autofocus",8,!1),c=H(e,"disabled",8,!1),h=H(e,"disableAnimation",8,!1),u=As(),d=As(!1),m=As(0);To(()=>{l()&&rt(u)&&rt(u).focus()});const y=(T,S)=>(h()&&(S.duration=0),S.fn(T,S)),p=T=>{T.target&&(Ot(m,T.target.getBoundingClientRect().top),Ot(d,!0))};li();var g=Wa(),k=ko(g);Ts(k,()=>t.label||n(),T=>{var S=Ka(),E=ct(S);Ts(E,()=>s()&&s().length>0&&rt(d),J=>{var I=xa(),Ee=ct(I);Lo(Ee,s),ft(I),Et(()=>Es(I,"top",rt(m)<window.innerHeight/2.5)),Oe(3,I,()=>Fa,()=>({x:-20,duration:100})),lt(J,I)});var A=ut(E,2),B=ct(A),j=ut(B);Ui(j,e,"label",{}),ft(A),ft(S),Et(()=>{Es(A,"nowrap",a()),Vr(B,`${(n()||"")??""} `)}),Oe(1,A,()=>y,()=>({fn:De})),Oe(2,A,()=>De),qi("mouseenter",A,p),qi("mouseleave",A,()=>Ot(d,!1)),Oe(1,S,()=>y,()=>({fn:De})),Oe(2,S,()=>y,()=>({fn:De})),lt(T,S)});var b=ut(k,2),v=ct(b);Ts(v,()=>!!r()||r()===""||r()===0,T=>{var S=Ua();Eo(S,E=>Ot(u,E),()=>rt(u)),js(S),Et(()=>{S.disabled=c(),xs(S,"placeholder",o())}),Ks(S,r),lt(T,S)});var _=ut(v,2);return Ui(_,e,"default",{}),ft(b),Et(()=>Es(b,"labeled",!!n())),Oe(1,b,()=>y,()=>({fn:De})),Oe(2,b,()=>y,()=>({fn:De})),lt(i,g),Mo(e,"maybe",y),ai({maybe:y})}class Va{constructor(){f(this,"requirements",{});f(this,"requireValue",(e,t)=>(this.requirements[e]=t,this));f(this,"meetsRequirements",e=>{for(const t in this.requirements)if(!this.requirements[t].includes(e.getData(!0)[t]))return!1;return!0});f(this,"meetsPreviewRequirements",e=>{for(const t in this.requirements)if(!this.requirements[t].includes(e.getRawPreviewData()[t]))return!1;return!0})}}const mt=class mt extends $a{constructor(t,s=!1){super("trigger",t,s);f(this,"mana",!1);f(this,"cooldown",!1);f(this,"clone",()=>new mt({name:this.name,components:[...w(this.components)],mana:this.mana,cooldown:this.cooldown,data:[...this.data],preview:[...this.preview],comment:this.comment,description:this.description,summaryItems:[...this.summaryItems]}));this.mana=t.mana||!1,this.cooldown=t.cooldown||!1}getData(t=!1){const s={};return this.name!="Cast"&&this.name!="Initialize"&&this.name!="Cleanup"&&(s.mana=this.mana,s.cooldown=this.cooldown),this.data.filter(n=>t||n.meetsRequirements(this)).forEach(n=>{const r=n.getData();Object.keys(r).forEach(o=>s[o]=r[o])}),s}deserialize(t){super.deserialize(t);const s=t.data;s&&(this.mana=ie(s.mana),this.cooldown=ie(s.cooldown),this.data.forEach(n=>n.deserialize(s))),t.children&&Object.keys(t.children).length>0&&this.setComponents(gt.deserializeComponents(t.children))}};f(mt,"new",()=>new mt({name:"null"}));let Qt=mt;var za=vt('<div class="wrap svelte-1x8zii"><input class="base svelte-1x8zii" placeholder="0"> +( <input class="modifier svelte-1x8zii" placeholder="0">  )</div>');function Ja(i,e){oi(e,!1);let t=H(e,"value",12);li();var s=za(),n=ct(s);js(n);var r=ut(n,2);js(r),vo(),ft(s),Ks(n,()=>t().base,o=>t(t().base=o,!0)),Ks(r,()=>t().scale,o=>t(t().scale=o,!0)),lt(i,s),ai()}function Ha(i,e){oi(e,!1);let t=H(e,"data",12),s=H(e,"name",8,""),n=H(e,"tooltip",8,void 0);const r=Oo();So(()=>Ao(t()),()=>{t()&&r("save")}),_o(),li(),Ya(i,{get label(){return s()},get tooltip(){return n()},children:(o,a)=>{Ja(o,{get value(){return t()},set value(l){t(l)},$$legacy:!0})},$$slots:{default:!0}}),ai()}class D{constructor(e,t,s){f(this,"name");f(this,"base");f(this,"scale");this.name=e,this.base=t,this.scale=s}}class as extends Va{constructor(t,s,n=0,r=0){super();f(this,"component",Ha);f(this,"name");f(this,"key");f(this,"data");f(this,"tooltip");f(this,"setTooltip",t=>(this.tooltip=t,this));f(this,"clone",()=>new as(this.name,this.key,this.data.base,this.data.scale));f(this,"getData",()=>{const t={};return t[`${this.key}-base`]=this.data.base||0,t[`${this.key}-scale`]=this.data.scale||0,t});f(this,"getSummary",()=>this.data.base.toString());f(this,"deserialize",t=>{this.data.base=t[`${this.key}-base`]||0,this.data.scale=t[`${this.key}-scale`]||0});this.name=t,this.key=s,this.data=new D(t,n,r)}}const mi=Symbol.for("yaml.alias"),Hs=Symbol.for("yaml.document"),_e=Symbol.for("yaml.map"),Yn=Symbol.for("yaml.pair"),ge=Symbol.for("yaml.scalar"),Xe=Symbol.for("yaml.seq"),Z=Symbol.for("yaml.node.type"),$e=i=>!!i&&typeof i=="object"&&i[Z]===mi,Pe=i=>!!i&&typeof i=="object"&&i[Z]===Hs,Ze=i=>!!i&&typeof i=="object"&&i[Z]===_e,R=i=>!!i&&typeof i=="object"&&i[Z]===Yn,L=i=>!!i&&typeof i=="object"&&i[Z]===ge,et=i=>!!i&&typeof i=="object"&&i[Z]===Xe;function $(i){if(i&&typeof i=="object")switch(i[Z]){case _e:case Xe:return!0}return!1}function P(i){if(i&&typeof i=="object")switch(i[Z]){case mi:case _e:case ge:case Xe:return!0}return!1}const Qa=i=>(L(i)||$(i))&&!!i.anchor,Y=Symbol("break visit"),Vn=Symbol("skip children"),de=Symbol("remove node");function Ae(i,e){const t=zn(e);Pe(i)?je(null,i.contents,t,Object.freeze([i]))===de&&(i.contents=null):je(null,i,t,Object.freeze([]))}Ae.BREAK=Y;Ae.SKIP=Vn;Ae.REMOVE=de;function je(i,e,t,s){const n=Jn(i,e,t,s);if(P(n)||R(n))return Hn(i,s,n),je(i,n,t,s);if(typeof n!="symbol"){if($(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=je(r,e.items[r],t,s);if(typeof o=="number")r=o-1;else{if(o===Y)return Y;o===de&&(e.items.splice(r,1),r-=1)}}}else if(R(e)){s=Object.freeze(s.concat(e));const r=je("key",e.key,t,s);if(r===Y)return Y;r===de&&(e.key=null);const o=je("value",e.value,t,s);if(o===Y)return Y;o===de&&(e.value=null)}}return n}async function ls(i,e){const t=zn(e);Pe(i)?await xe(null,i.contents,t,Object.freeze([i]))===de&&(i.contents=null):await xe(null,i,t,Object.freeze([]))}ls.BREAK=Y;ls.SKIP=Vn;ls.REMOVE=de;async function xe(i,e,t,s){const n=await Jn(i,e,t,s);if(P(n)||R(n))return Hn(i,s,n),xe(i,n,t,s);if(typeof n!="symbol"){if($(e)){s=Object.freeze(s.concat(e));for(let r=0;r<e.items.length;++r){const o=await xe(r,e.items[r],t,s);if(typeof o=="number")r=o-1;else{if(o===Y)return Y;o===de&&(e.items.splice(r,1),r-=1)}}}else if(R(e)){s=Object.freeze(s.concat(e));const r=await xe("key",e.key,t,s);if(r===Y)return Y;r===de&&(e.key=null);const o=await xe("value",e.value,t,s);if(o===Y)return Y;o===de&&(e.value=null)}}return n}function zn(i){return typeof i=="object"&&(i.Collection||i.Node||i.Value)?Object.assign({Alias:i.Node,Map:i.Node,Scalar:i.Node,Seq:i.Node},i.Value&&{Map:i.Value,Scalar:i.Value,Seq:i.Value},i.Collection&&{Map:i.Collection,Seq:i.Collection},i):i}function Jn(i,e,t,s){var n,r,o,a,l;if(typeof t=="function")return t(i,e,s);if(Ze(e))return(n=t.Map)==null?void 0:n.call(t,i,e,s);if(et(e))return(r=t.Seq)==null?void 0:r.call(t,i,e,s);if(R(e))return(o=t.Pair)==null?void 0:o.call(t,i,e,s);if(L(e))return(a=t.Scalar)==null?void 0:a.call(t,i,e,s);if($e(e))return(l=t.Alias)==null?void 0:l.call(t,i,e,s)}function Hn(i,e,t){const s=e[e.length-1];if($(s))s.items[i]=t;else if(R(s))i==="key"?s.key=t:s.value=t;else if(Pe(s))s.contents=t;else{const n=$e(s)?"alias":"scalar";throw new Error(`Cannot replace node with ${n} parent`)}}const Ga={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},Xa=i=>i.replace(/[!,[\]{}]/g,e=>Ga[e]);class K{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},K.defaultYaml,e),this.tags=Object.assign({},K.defaultTags,t)}clone(){const e=new K(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new K(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:K.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},K.defaultTags);break}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:K.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},K.defaultTags),this.atNextDocument=!1);const s=e.trim().split(/[ \t]+/),n=s.shift();switch(n){case"%TAG":{if(s.length!==2&&(t(0,"%TAG directive should contain exactly two parts"),s.length<2))return!1;const[r,o]=s;return this.tags[r]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,s.length!==1)return t(0,"%YAML directive should contain exactly one part"),!1;const[r]=s;if(r==="1.1"||r==="1.2")return this.yaml.version=r,!0;{const o=/^\d+\.\d+$/.test(r);return t(6,`Unsupported YAML version ${r}`,o),!1}}default:return t(0,`Unknown directive ${n}`,!0),!1}}tagName(e,t){if(e==="!")return"!";if(e[0]!=="!")return t(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&t("Verbatim tags must end with a >"),o)}const[,s,n]=e.match(/^(.*!)([^!]*)$/s);n||t(`The ${e} tag has no suffix`);const r=this.tags[s];if(r)try{return r+decodeURIComponent(n)}catch(o){return t(String(o)),null}return s==="!"?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[t,s]of Object.entries(this.tags))if(e.startsWith(s))return t+Xa(e.substring(s.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],s=Object.entries(this.tags);let n;if(e&&s.length>0&&P(e.contents)){const r={};Ae(e.contents,(o,a)=>{P(a)&&a.tag&&(r[a.tag]=!0)}),n=Object.keys(r)}else n=[];for(const[r,o]of s)r==="!!"&&o==="tag:yaml.org,2002:"||(!e||n.some(a=>a.startsWith(o)))&&t.push(`%TAG ${r} ${o}`);return t.join(`
`)}}K.defaultYaml={explicit:!1,version:"1.2"};K.defaultTags={"!!":"tag:yaml.org,2002:"};function Qn(i){if(/[\x00-\x19\s,[\]{}]/.test(i)){const t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(i)}`;throw new Error(t)}return!0}function Gn(i){const e=new Set;return Ae(i,{Value(t,s){s.anchor&&e.add(s.anchor)}}),e}function Xn(i,e){for(let t=1;;++t){const s=`${i}${t}`;if(!e.has(s))return s}}function Za(i,e){const t=[],s=new Map;let n=null;return{onAnchor:r=>{t.push(r),n||(n=Gn(i));const o=Xn(e,n);return n.add(o),o},setAnchors:()=>{for(const r of t){const o=s.get(r);if(typeof o=="object"&&o.anchor&&(L(o.node)||$(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=r,a}}},sourceObjects:s}}function Ke(i,e,t,s){if(s&&typeof s=="object")if(Array.isArray(s))for(let n=0,r=s.length;n<r;++n){const o=s[n],a=Ke(i,s,String(n),o);a===void 0?delete s[n]:a!==o&&(s[n]=a)}else if(s instanceof Map)for(const n of Array.from(s.keys())){const r=s.get(n),o=Ke(i,s,n,r);o===void 0?s.delete(n):o!==r&&s.set(n,o)}else if(s instanceof Set)for(const n of Array.from(s)){const r=Ke(i,s,n,n);r===void 0?s.delete(n):r!==n&&(s.delete(n),s.add(r))}else for(const[n,r]of Object.entries(s)){const o=Ke(i,s,n,r);o===void 0?delete s[n]:o!==r&&(s[n]=o)}return i.call(e,t,s)}function X(i,e,t){if(Array.isArray(i))return i.map((s,n)=>X(s,String(n),t));if(i&&typeof i.toJSON=="function"){if(!t||!Qa(i))return i.toJSON(e,t);const s={aliasCount:0,count:1,res:void 0};t.anchors.set(i,s),t.onCreate=r=>{s.res=r,delete t.onCreate};const n=i.toJSON(e,t);return t.onCreate&&t.onCreate(n),n}return typeof i=="bigint"&&!(t!=null&&t.keep)?Number(i):i}class gi{constructor(e){Object.defineProperty(this,Z,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:s,onAnchor:n,reviver:r}={}){if(!Pe(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},a=X(this,"",o);if(typeof n=="function")for(const{count:l,res:c}of o.anchors.values())n(c,l);return typeof r=="function"?Ke(r,{"":a},"",a):a}}class cs extends gi{constructor(e){super(mi),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e){let t;return Ae(e,{Node:(s,n)=>{if(n===this)return Ae.BREAK;n.anchor===this.source&&(t=n)}}),t}toJSON(e,t){if(!t)return{source:this.source};const{anchors:s,doc:n,maxAliasCount:r}=t,o=this.resolve(n);if(!o){const l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=s.get(o);if(a||(X(o,null,t),a=s.get(o)),!a||a.res===void 0){const l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(r>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=xt(n,o,s)),a.count*a.aliasCount>r)){const l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,t,s){const n=`*${this.source}`;if(e){if(Qn(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(r)}if(e.implicitKey)return`${n} `}return n}}function xt(i,e,t){if($e(e)){const s=e.resolve(i),n=t&&s&&t.get(s);return n?n.count*n.aliasCount:0}else if($(e)){let s=0;for(const n of e.items){const r=xt(i,n,t);r>s&&(s=r)}return s}else if(R(e)){const s=xt(i,e.key,t),n=xt(i,e.value,t);return Math.max(s,n)}return 1}const Zn=i=>!i||typeof i!="function"&&typeof i!="object";class O extends gi{constructor(e){super(ge),this.value=e}toJSON(e,t){return t!=null&&t.keep?this.value:X(this.value,e,t)}toString(){return String(this.value)}}O.BLOCK_FOLDED="BLOCK_FOLDED";O.BLOCK_LITERAL="BLOCK_LITERAL";O.PLAIN="PLAIN";O.QUOTE_DOUBLE="QUOTE_DOUBLE";O.QUOTE_SINGLE="QUOTE_SINGLE";const el="tag:yaml.org,2002:";function tl(i,e,t){if(e){const s=t.filter(r=>r.tag===e),n=s.find(r=>!r.format)??s[0];if(!n)throw new Error(`Tag ${e} not found`);return n}return t.find(s=>{var n;return((n=s.identify)==null?void 0:n.call(s,i))&&!s.format})}function yt(i,e,t){var u,d,m;if(Pe(i)&&(i=i.contents),P(i))return i;if(R(i)){const y=(d=(u=t.schema[_e]).createNode)==null?void 0:d.call(u,t.schema,null,t);return y.items.push(i),y}(i instanceof String||i instanceof Number||i instanceof Boolean||typeof BigInt<"u"&&i instanceof BigInt)&&(i=i.valueOf());const{aliasDuplicateObjects:s,onAnchor:n,onTagObj:r,schema:o,sourceObjects:a}=t;let l;if(s&&i&&typeof i=="object"){if(l=a.get(i),l)return l.anchor||(l.anchor=n(i)),new cs(l.anchor);l={anchor:null,node:null},a.set(i,l)}e!=null&&e.startsWith("!!")&&(e=el+e.slice(2));let c=tl(i,e,o.tags);if(!c){if(i&&typeof i.toJSON=="function"&&(i=i.toJSON()),!i||typeof i!="object"){const y=new O(i);return l&&(l.node=y),y}c=i instanceof Map?o[_e]:Symbol.iterator in Object(i)?o[Xe]:o[_e]}r&&(r(c),delete t.onTagObj);const h=c!=null&&c.createNode?c.createNode(t.schema,i,t):typeof((m=c==null?void 0:c.nodeClass)==null?void 0:m.from)=="function"?c.nodeClass.from(t.schema,i,t):new O(i);return e?h.tag=e:c.default||(h.tag=c.tag),l&&(l.node=h),h}function Gt(i,e,t){let s=t;for(let n=e.length-1;n>=0;--n){const r=e[n];if(typeof r=="number"&&Number.isInteger(r)&&r>=0){const o=[];o[r]=s,s=o}else s=new Map([[r,s]])}return yt(s,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:i,sourceObjects:new Map})}const dt=i=>i==null||typeof i=="object"&&!!i[Symbol.iterator]().next().done;class er extends gi{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(s=>P(s)||R(s)?s.clone(e):s),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(dt(e))this.add(t);else{const[s,...n]=e,r=this.get(s,!0);if($(r))r.addIn(n,t);else if(r===void 0&&this.schema)this.set(s,Gt(this.schema,n,t));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${n}`)}}deleteIn(e){const[t,...s]=e;if(s.length===0)return this.delete(t);const n=this.get(t,!0);if($(n))return n.deleteIn(s);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${s}`)}getIn(e,t){const[s,...n]=e,r=this.get(s,!0);return n.length===0?!t&&L(r)?r.value:r:$(r)?r.getIn(n,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!R(t))return!1;const s=t.value;return s==null||e&&L(s)&&s.value==null&&!s.commentBefore&&!s.comment&&!s.tag})}hasIn(e){const[t,...s]=e;if(s.length===0)return this.has(t);const n=this.get(t,!0);return $(n)?n.hasIn(s):!1}setIn(e,t){const[s,...n]=e;if(n.length===0)this.set(s,t);else{const r=this.get(s,!0);if($(r))r.setIn(n,t);else if(r===void 0&&this.schema)this.set(s,Gt(this.schema,n,t));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${n}`)}}}const sl=i=>i.replace(/^(?!$)(?: $)?/gm,"#");function ye(i,e){return/^\n+$/.test(i)?i.substring(1):e?i.replace(/^(?! *$)/gm,e):i}const Ie=(i,e,t)=>i.endsWith(`
`)?ye(t,e):t.includes(`
`)?`
`+ye(t,e):(i.endsWith(" ")?"":" ")+t,tr="flow",Qs="block",Kt="quoted";function fs(i,e,t="flow",{indentAtStart:s,lineWidth:n=80,minContentWidth:r=20,onFold:o,onOverflow:a}={}){if(!n||n<0)return i;n<r&&(r=0);const l=Math.max(1+r,1+n-e.length);if(i.length<=l)return i;const c=[],h={};let u=n-e.length;typeof s=="number"&&(s>n-Math.max(2,r)?c.push(0):u=n-s);let d,m,y=!1,p=-1,g=-1,k=-1;t===Qs&&(p=tn(i,p,e.length),p!==-1&&(u=p+l));for(let v;v=i[p+=1];){if(t===Kt&&v==="\\"){switch(g=p,i[p+1]){case"x":p+=3;break;case"u":p+=5;break;case"U":p+=9;break;default:p+=1}k=p}if(v===`
`)t===Qs&&(p=tn(i,p,e.length)),u=p+e.length+l,d=void 0;else{if(v===" "&&m&&m!==" "&&m!==`
`&&m!=="	"){const _=i[p+1];_&&_!==" "&&_!==`
`&&_!=="	"&&(d=p)}if(p>=u)if(d)c.push(d),u=d+l,d=void 0;else if(t===Kt){for(;m===" "||m==="	";)m=v,v=i[p+=1],y=!0;const _=p>k+1?p-2:g-1;if(h[_])return i;c.push(_),h[_]=!0,u=_+l,d=void 0}else y=!0}m=v}if(y&&a&&a(),c.length===0)return i;o&&o();let b=i.slice(0,c[0]);for(let v=0;v<c.length;++v){const _=c[v],T=c[v+1]||i.length;_===0?b=`
${e}${i.slice(0,T)}`:(t===Kt&&h[_]&&(b+=`${i[_]}\\`),b+=`
${e}${i.slice(_+1,T)}`)}return b}function tn(i,e,t){let s=e,n=e+1,r=i[n];for(;r===" "||r==="	";)if(e<n+t)r=i[++e];else{do r=i[++e];while(r&&r!==`
`);s=e,n=e+1,r=i[n]}return s}const us=(i,e)=>({indentAtStart:e?i.indent.length:i.indentAtStart,lineWidth:i.options.lineWidth,minContentWidth:i.options.minContentWidth}),hs=i=>/^(%|---|\.\.\.)/m.test(i);function il(i,e,t){if(!e||e<0)return!1;const s=e-t,n=i.length;if(n<=s)return!1;for(let r=0,o=0;r<n;++r)if(i[r]===`
`){if(r-o>s)return!0;if(o=r+1,n-o<=s)return!1}return!0}function pt(i,e){const t=JSON.stringify(i);if(e.options.doubleQuotedAsJSON)return t;const{implicitKey:s}=e,n=e.options.doubleQuotedMinMultiLineLength,r=e.indent||(hs(i)?"  ":"");let o="",a=0;for(let l=0,c=t[l];c;c=t[++l])if(c===" "&&t[l+1]==="\\"&&t[l+2]==="n"&&(o+=t.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),c==="\\")switch(t[l+1]){case"u":{o+=t.slice(a,l);const h=t.substr(l+2,4);switch(h){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:h.substr(0,2)==="00"?o+="\\x"+h.substr(2):o+=t.substr(l,6)}l+=5,a=l+1}break;case"n":if(s||t[l+2]==='"'||t.length<n)l+=1;else{for(o+=t.slice(a,l)+`

`;t[l+2]==="\\"&&t[l+3]==="n"&&t[l+4]!=='"';)o+=`
`,l+=2;o+=r,t[l+2]===" "&&(o+="\\"),l+=1,a=l+1}break;default:l+=1}return o=a?o+t.slice(a):t,s?o:fs(o,r,Kt,us(e,!1))}function Gs(i,e){if(e.options.singleQuote===!1||e.implicitKey&&i.includes(`
`)||/[ \t]\n|\n[ \t]/.test(i))return pt(i,e);const t=e.indent||(hs(i)?"  ":""),s="'"+i.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?s:fs(s,t,tr,us(e,!1))}function Ue(i,e){const{singleQuote:t}=e.options;let s;if(t===!1)s=pt;else{const n=i.includes('"'),r=i.includes("'");n&&!r?s=Gs:r&&!n?s=pt:s=t?Gs:pt}return s(i,e)}let Xs;try{Xs=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Xs=/\n+(?!\n|$)/g}function Ut({comment:i,type:e,value:t},s,n,r){const{blockQuote:o,commentString:a,lineWidth:l}=s.options;if(!o||/\n[\t ]+$/.test(t)||/^\s*$/.test(t))return Ue(t,s);const c=s.indent||(s.forceBlockIndent||hs(t)?"  ":""),h=o==="literal"?!0:o==="folded"||e===O.BLOCK_FOLDED?!1:e===O.BLOCK_LITERAL?!0:!il(t,l,c.length);if(!t)return h?`|
`:`>
`;let u,d;for(d=t.length;d>0;--d){const S=t[d-1];if(S!==`
`&&S!=="	"&&S!==" ")break}let m=t.substring(d);const y=m.indexOf(`
`);y===-1?u="-":t===m||y!==m.length-1?(u="+",r&&r()):u="",m&&(t=t.slice(0,-m.length),m[m.length-1]===`
`&&(m=m.slice(0,-1)),m=m.replace(Xs,`$&${c}`));let p=!1,g,k=-1;for(g=0;g<t.length;++g){const S=t[g];if(S===" ")p=!0;else if(S===`
`)k=g;else break}let b=t.substring(0,k<g?k+1:g);b&&(t=t.substring(b.length),b=b.replace(/\n+/g,`$&${c}`));let _=(h?"|":">")+(p?c?"2":"1":"")+u;if(i&&(_+=" "+a(i.replace(/ ?[\r\n]+/g," ")),n&&n()),h)return t=t.replace(/\n+/g,`$&${c}`),`${_}
${c}${b}${t}${m}`;t=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);const T=fs(`${b}${t}${m}`,c,Qs,us(s,!0));return`${_}
${c}${T}`}function nl(i,e,t,s){const{type:n,value:r}=i,{actualString:o,implicitKey:a,indent:l,indentStep:c,inFlow:h}=e;if(a&&r.includes(`
`)||h&&/[[\]{},]/.test(r))return Ue(r,e);if(!r||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(r))return a||h||!r.includes(`
`)?Ue(r,e):Ut(i,e,t,s);if(!a&&!h&&n!==O.PLAIN&&r.includes(`
`))return Ut(i,e,t,s);if(hs(r)){if(l==="")return e.forceBlockIndent=!0,Ut(i,e,t,s);if(a&&l===c)return Ue(r,e)}const u=r.replace(/\n+/g,`$&
${l}`);if(o){const d=p=>{var g;return p.default&&p.tag!=="tag:yaml.org,2002:str"&&((g=p.test)==null?void 0:g.test(u))},{compat:m,tags:y}=e.doc.schema;if(y.some(d)||m!=null&&m.some(d))return Ue(r,e)}return a?u:fs(u,l,tr,us(e,!1))}function St(i,e,t,s){const{implicitKey:n,inFlow:r}=e,o=typeof i.value=="string"?i:Object.assign({},i,{value:String(i.value)});let{type:a}=i;a!==O.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=O.QUOTE_DOUBLE);const l=h=>{switch(h){case O.BLOCK_FOLDED:case O.BLOCK_LITERAL:return n||r?Ue(o.value,e):Ut(o,e,t,s);case O.QUOTE_DOUBLE:return pt(o.value,e);case O.QUOTE_SINGLE:return Gs(o.value,e);case O.PLAIN:return nl(o,e,t,s);default:return null}};let c=l(a);if(c===null){const{defaultKeyType:h,defaultStringType:u}=e.options,d=n&&h||u;if(c=l(d),c===null)throw new Error(`Unsupported default string type ${d}`)}return c}function sr(i,e){const t=Object.assign({blockQuote:!0,commentString:sl,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},i.schema.toStringOptions,e);let s;switch(t.collectionStyle){case"block":s=!1;break;case"flow":s=!0;break;default:s=null}return{anchors:new Set,doc:i,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:s,options:t}}function rl(i,e){var n;if(e.tag){const r=i.filter(o=>o.tag===e.tag);if(r.length>0)return r.find(o=>o.format===e.format)??r[0]}let t,s;if(L(e)){s=e.value;let r=i.filter(o=>{var a;return(a=o.identify)==null?void 0:a.call(o,s)});if(r.length>1){const o=r.filter(a=>a.test);o.length>0&&(r=o)}t=r.find(o=>o.format===e.format)??r.find(o=>!o.format)}else s=e,t=i.find(r=>r.nodeClass&&s instanceof r.nodeClass);if(!t){const r=((n=s==null?void 0:s.constructor)==null?void 0:n.name)??typeof s;throw new Error(`Tag not resolved for ${r} value`)}return t}function ol(i,e,{anchors:t,doc:s}){if(!s.directives)return"";const n=[],r=(L(i)||$(i))&&i.anchor;r&&Qn(r)&&(t.add(r),n.push(`&${r}`));const o=i.tag?i.tag:e.default?null:e.tag;return o&&n.push(s.directives.tagString(o)),n.join(" ")}function He(i,e,t,s){var l;if(R(i))return i.toString(e,t,s);if($e(i)){if(e.doc.directives)return i.toString(e);if((l=e.resolvedAliases)!=null&&l.has(i))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(i):e.resolvedAliases=new Set([i]),i=i.resolve(e.doc)}let n;const r=P(i)?i:e.doc.createNode(i,{onTagObj:c=>n=c});n||(n=rl(e.doc.schema.tags,r));const o=ol(r,n,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const a=typeof n.stringify=="function"?n.stringify(r,e,t,s):L(r)?St(r,e,t,s):r.toString(e,t,s);return o?L(r)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${e.indent}${a}`:a}function al({key:i,value:e},t,s,n){const{allNullValues:r,doc:o,indent:a,indentStep:l,options:{commentString:c,indentSeq:h,simpleKeys:u}}=t;let d=P(i)&&i.comment||null;if(u){if(d)throw new Error("With simple keys, key nodes cannot have comments");if($(i)||!P(i)&&typeof i=="object"){const E="With simple keys, collection cannot be used as a key value";throw new Error(E)}}let m=!u&&(!i||d&&e==null&&!t.inFlow||$(i)||(L(i)?i.type===O.BLOCK_FOLDED||i.type===O.BLOCK_LITERAL:typeof i=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!m&&(u||!r),indent:a+l});let y=!1,p=!1,g=He(i,t,()=>y=!0,()=>p=!0);if(!m&&!t.inFlow&&g.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");m=!0}if(t.inFlow){if(r||e==null)return y&&s&&s(),g===""?"?":m?`? ${g}`:g}else if(r&&!u||e==null&&m)return g=`? ${g}`,d&&!y?g+=Ie(g,t.indent,c(d)):p&&n&&n(),g;y&&(d=null),m?(d&&(g+=Ie(g,t.indent,c(d))),g=`? ${g}
${a}:`):(g=`${g}:`,d&&(g+=Ie(g,t.indent,c(d))));let k,b,v;P(e)?(k=!!e.spaceBefore,b=e.commentBefore,v=e.comment):(k=!1,b=null,v=null,e&&typeof e=="object"&&(e=o.createNode(e))),t.implicitKey=!1,!m&&!d&&L(e)&&(t.indentAtStart=g.length+1),p=!1,!h&&l.length>=2&&!t.inFlow&&!m&&et(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let _=!1;const T=He(e,t,()=>_=!0,()=>p=!0);let S=" ";if(d||k||b){if(S=k?`
`:"",b){const E=c(b);S+=`
${ye(E,t.indent)}`}T===""&&!t.inFlow?S===`
`&&(S=`

`):S+=`
${t.indent}`}else if(!m&&$(e)){const E=T[0],A=T.indexOf(`
`),B=A!==-1,j=t.inFlow??e.flow??e.items.length===0;if(B||!j){let J=!1;if(B&&(E==="&"||E==="!")){let I=T.indexOf(" ");E==="&"&&I!==-1&&I<A&&T[I+1]==="!"&&(I=T.indexOf(" ",I+1)),(I===-1||A<I)&&(J=!0)}J||(S=`
${t.indent}`)}}else(T===""||T[0]===`
`)&&(S="");return g+=S+T,t.inFlow?_&&s&&s():v&&!_?g+=Ie(g,t.indent,c(v)):p&&n&&n(),g}function ir(i,e){(i==="debug"||i==="warn")&&(typeof process<"u"&&process.emitWarning?process.emitWarning(e):console.warn(e))}const Lt="<<",be={identify:i=>i===Lt||typeof i=="symbol"&&i.description===Lt,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new O(Symbol(Lt)),{addToJSMap:nr}),stringify:()=>Lt},ll=(i,e)=>(be.identify(e)||L(e)&&(!e.type||e.type===O.PLAIN)&&be.identify(e.value))&&(i==null?void 0:i.doc.schema.tags.some(t=>t.tag===be.tag&&t.default));function nr(i,e,t){if(t=i&&$e(t)?t.resolve(i.doc):t,et(t))for(const s of t.items)Bs(i,e,s);else if(Array.isArray(t))for(const s of t)Bs(i,e,s);else Bs(i,e,t)}function Bs(i,e,t){const s=i&&$e(t)?t.resolve(i.doc):t;if(!Ze(s))throw new Error("Merge sources must be maps or map aliases");const n=s.toJSON(null,i,Map);for(const[r,o]of n)e instanceof Map?e.has(r)||e.set(r,o):e instanceof Set?e.add(r):Object.prototype.hasOwnProperty.call(e,r)||Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function rr(i,e,{key:t,value:s}){if(P(t)&&t.addToJSMap)t.addToJSMap(i,e,s);else if(ll(i,t))nr(i,e,s);else{const n=X(t,"",i);if(e instanceof Map)e.set(n,X(s,n,i));else if(e instanceof Set)e.add(n);else{const r=cl(t,n,i),o=X(s,r,i);r in e?Object.defineProperty(e,r,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[r]=o}}return e}function cl(i,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if(P(i)&&(t!=null&&t.doc)){const s=sr(t.doc,{});s.anchors=new Set;for(const r of t.anchors.keys())s.anchors.add(r.anchor);s.inFlow=!0,s.inStringifyKey=!0;const n=i.toString(s);if(!t.mapKeyWarned){let r=JSON.stringify(n);r.length>40&&(r=r.substring(0,36)+'..."'),ir(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${r}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return n}return JSON.stringify(e)}function yi(i,e,t){const s=yt(i,void 0,t),n=yt(e,void 0,t);return new x(s,n)}class x{constructor(e,t=null){Object.defineProperty(this,Z,{value:Yn}),this.key=e,this.value=t}clone(e){let{key:t,value:s}=this;return P(t)&&(t=t.clone(e)),P(s)&&(s=s.clone(e)),new x(t,s)}toJSON(e,t){const s=t!=null&&t.mapAsMap?new Map:{};return rr(t,s,this)}toString(e,t,s){return e!=null&&e.doc?al(this,e,t,s):JSON.stringify(this)}}function or(i,e,t){return(e.inFlow??i.flow?ul:fl)(i,e,t)}function fl({comment:i,items:e},t,{blockItemPrefix:s,flowChars:n,itemIndent:r,onChompKeep:o,onComment:a}){const{indent:l,options:{commentString:c}}=t,h=Object.assign({},t,{indent:r,type:null});let u=!1;const d=[];for(let y=0;y<e.length;++y){const p=e[y];let g=null;if(P(p))!u&&p.spaceBefore&&d.push(""),Xt(t,d,p.commentBefore,u),p.comment&&(g=p.comment);else if(R(p)){const b=P(p.key)?p.key:null;b&&(!u&&b.spaceBefore&&d.push(""),Xt(t,d,b.commentBefore,u))}u=!1;let k=He(p,h,()=>g=null,()=>u=!0);g&&(k+=Ie(k,r,c(g))),u&&g&&(u=!1),d.push(s+k)}let m;if(d.length===0)m=n.start+n.end;else{m=d[0];for(let y=1;y<d.length;++y){const p=d[y];m+=p?`
${l}${p}`:`
`}}return i?(m+=`
`+ye(c(i),l),a&&a()):u&&o&&o(),m}function ul({items:i},e,{flowChars:t,itemIndent:s}){const{indent:n,indentStep:r,flowCollectionPadding:o,options:{commentString:a}}=e;s+=r;const l=Object.assign({},e,{indent:s,inFlow:!0,type:null});let c=!1,h=0;const u=[];for(let y=0;y<i.length;++y){const p=i[y];let g=null;if(P(p))p.spaceBefore&&u.push(""),Xt(e,u,p.commentBefore,!1),p.comment&&(g=p.comment);else if(R(p)){const b=P(p.key)?p.key:null;b&&(b.spaceBefore&&u.push(""),Xt(e,u,b.commentBefore,!1),b.comment&&(c=!0));const v=P(p.value)?p.value:null;v?(v.comment&&(g=v.comment),v.commentBefore&&(c=!0)):p.value==null&&(b!=null&&b.comment)&&(g=b.comment)}g&&(c=!0);let k=He(p,l,()=>g=null);y<i.length-1&&(k+=","),g&&(k+=Ie(k,s,a(g))),!c&&(u.length>h||k.includes(`
`))&&(c=!0),u.push(k),h=u.length}const{start:d,end:m}=t;if(u.length===0)return d+m;if(!c){const y=u.reduce((p,g)=>p+g.length+2,2);c=e.options.lineWidth>0&&y>e.options.lineWidth}if(c){let y=d;for(const p of u)y+=p?`
${r}${n}${p}`:`
`;return`${y}
${n}${m}`}else return`${d}${o}${u.join(" ")}${o}${m}`}function Xt({indent:i,options:{commentString:e}},t,s,n){if(s&&n&&(s=s.replace(/^\n+/,"")),s){const r=ye(e(s),i);t.push(r.trimStart())}}function Le(i,e){const t=L(e)?e.value:e;for(const s of i)if(R(s)&&(s.key===e||s.key===t||L(s.key)&&s.key.value===t))return s}class V extends er{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(_e,e),this.items=[]}static from(e,t,s){const{keepUndefined:n,replacer:r}=s,o=new this(e),a=(l,c)=>{if(typeof r=="function")c=r.call(t,l,c);else if(Array.isArray(r)&&!r.includes(l))return;(c!==void 0||n)&&o.items.push(yi(l,c,s))};if(t instanceof Map)for(const[l,c]of t)a(l,c);else if(t&&typeof t=="object")for(const l of Object.keys(t))a(l,t[l]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,t){var o;let s;R(e)?s=e:!e||typeof e!="object"||!("key"in e)?s=new x(e,e==null?void 0:e.value):s=new x(e.key,e.value);const n=Le(this.items,s.key),r=(o=this.schema)==null?void 0:o.sortMapEntries;if(n){if(!t)throw new Error(`Key ${s.key} already set`);L(n.value)&&Zn(s.value)?n.value.value=s.value:n.value=s.value}else if(r){const a=this.items.findIndex(l=>r(s,l)<0);a===-1?this.items.push(s):this.items.splice(a,0,s)}else this.items.push(s)}delete(e){const t=Le(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){const s=Le(this.items,e),n=s==null?void 0:s.value;return(!t&&L(n)?n.value:n)??void 0}has(e){return!!Le(this.items,e)}set(e,t){this.add(new x(e,t),!0)}toJSON(e,t,s){const n=s?new s:t!=null&&t.mapAsMap?new Map:{};t!=null&&t.onCreate&&t.onCreate(n);for(const r of this.items)rr(t,n,r);return n}toString(e,t,s){if(!e)return JSON.stringify(this);for(const n of this.items)if(!R(n))throw new Error(`Map items must all be pairs; found ${JSON.stringify(n)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),or(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:s,onComment:t})}}const tt={collection:"map",default:!0,nodeClass:V,tag:"tag:yaml.org,2002:map",resolve(i,e){return Ze(i)||e("Expected a mapping for this tag"),i},createNode:(i,e,t)=>V.from(i,e,t)};class Te extends er{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(Xe,e),this.items=[]}add(e){this.items.push(e)}delete(e){const t=Bt(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){const s=Bt(e);if(typeof s!="number")return;const n=this.items[s];return!t&&L(n)?n.value:n}has(e){const t=Bt(e);return typeof t=="number"&&t<this.items.length}set(e,t){const s=Bt(e);if(typeof s!="number")throw new Error(`Expected a valid index, not ${e}.`);const n=this.items[s];L(n)&&Zn(t)?n.value=t:this.items[s]=t}toJSON(e,t){const s=[];t!=null&&t.onCreate&&t.onCreate(s);let n=0;for(const r of this.items)s.push(X(r,String(n++),t));return s}toString(e,t,s){return e?or(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:s,onComment:t}):JSON.stringify(this)}static from(e,t,s){const{replacer:n}=s,r=new this(e);if(t&&Symbol.iterator in Object(t)){let o=0;for(let a of t){if(typeof n=="function"){const l=t instanceof Set?a:String(o++);a=n.call(t,l,a)}r.items.push(yt(a,void 0,s))}}return r}}function Bt(i){let e=L(i)?i.value:i;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const st={collection:"seq",default:!0,nodeClass:Te,tag:"tag:yaml.org,2002:seq",resolve(i,e){return et(i)||e("Expected a sequence for this tag"),i},createNode:(i,e,t)=>Te.from(i,e,t)},ds={identify:i=>typeof i=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:i=>i,stringify(i,e,t,s){return e=Object.assign({actualString:!0},e),St(i,e,t,s)}},ps={identify:i=>i==null,createNode:()=>new O(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new O(null),stringify:({source:i},e)=>typeof i=="string"&&ps.test.test(i)?i:e.options.nullStr},bi={identify:i=>typeof i=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:i=>new O(i[0]==="t"||i[0]==="T"),stringify({source:i,value:e},t){if(i&&bi.test.test(i)){const s=i[0]==="t"||i[0]==="T";if(e===s)return i}return e?t.options.trueStr:t.options.falseStr}};function ce({format:i,minFractionDigits:e,tag:t,value:s}){if(typeof s=="bigint")return String(s);const n=typeof s=="number"?s:Number(s);if(!isFinite(n))return isNaN(n)?".nan":n<0?"-.inf":".inf";let r=JSON.stringify(s);if(!i&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(r)){let o=r.indexOf(".");o<0&&(o=r.length,r+=".");let a=e-(r.length-o-1);for(;a-- >0;)r+="0"}return r}const ar={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:i=>i.slice(-3).toLowerCase()==="nan"?NaN:i[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ce},lr={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:i=>parseFloat(i),stringify(i){const e=Number(i.value);return isFinite(e)?e.toExponential():ce(i)}},cr={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(i){const e=new O(parseFloat(i)),t=i.indexOf(".");return t!==-1&&i[i.length-1]==="0"&&(e.minFractionDigits=i.length-t-1),e},stringify:ce},ms=i=>typeof i=="bigint"||Number.isInteger(i),wi=(i,e,t,{intAsBigInt:s})=>s?BigInt(i):parseInt(i.substring(e),t);function fr(i,e,t){const{value:s}=i;return ms(s)&&s>=0?t+s.toString(e):ce(i)}const ur={identify:i=>ms(i)&&i>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(i,e,t)=>wi(i,2,8,t),stringify:i=>fr(i,8,"0o")},hr={identify:ms,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(i,e,t)=>wi(i,0,10,t),stringify:ce},dr={identify:i=>ms(i)&&i>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(i,e,t)=>wi(i,2,16,t),stringify:i=>fr(i,16,"0x")},hl=[tt,st,ds,ps,bi,ur,hr,dr,ar,lr,cr];function sn(i){return typeof i=="bigint"||Number.isInteger(i)}const Rt=({value:i})=>JSON.stringify(i),dl=[{identify:i=>typeof i=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:i=>i,stringify:Rt},{identify:i=>i==null,createNode:()=>new O(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Rt},{identify:i=>typeof i=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:i=>i==="true",stringify:Rt},{identify:sn,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(i,e,{intAsBigInt:t})=>t?BigInt(i):parseInt(i,10),stringify:({value:i})=>sn(i)?i.toString():JSON.stringify(i)},{identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:i=>parseFloat(i),stringify:Rt}],pl={default:!0,tag:"",test:/^/,resolve(i,e){return e(`Unresolved plain scalar ${JSON.stringify(i)}`),i}},ml=[tt,st].concat(dl,pl),ki={identify:i=>i instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(i,e){if(typeof Buffer=="function")return Buffer.from(i,"base64");if(typeof atob=="function"){const t=atob(i.replace(/[\n\r]/g,"")),s=new Uint8Array(t.length);for(let n=0;n<t.length;++n)s[n]=t.charCodeAt(n);return s}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),i},stringify({comment:i,type:e,value:t},s,n,r){const o=t;let a;if(typeof Buffer=="function")a=o instanceof Buffer?o.toString("base64"):Buffer.from(o.buffer).toString("base64");else if(typeof btoa=="function"){let l="";for(let c=0;c<o.length;++c)l+=String.fromCharCode(o[c]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e||(e=O.BLOCK_LITERAL),e!==O.QUOTE_DOUBLE){const l=Math.max(s.options.lineWidth-s.indent.length,s.options.minContentWidth),c=Math.ceil(a.length/l),h=new Array(c);for(let u=0,d=0;u<c;++u,d+=l)h[u]=a.substr(d,l);a=h.join(e===O.BLOCK_LITERAL?`
`:" ")}return St({comment:i,type:e,value:a},s,n,r)}};function pr(i,e){if(et(i))for(let t=0;t<i.items.length;++t){let s=i.items[t];if(!R(s)){if(Ze(s)){s.items.length>1&&e("Each pair must have its own sequence indicator");const n=s.items[0]||new x(new O(null));if(s.commentBefore&&(n.key.commentBefore=n.key.commentBefore?`${s.commentBefore}
${n.key.commentBefore}`:s.commentBefore),s.comment){const r=n.value??n.key;r.comment=r.comment?`${s.comment}
${r.comment}`:s.comment}s=n}i.items[t]=R(s)?s:new x(s)}}else e("Expected a sequence for this tag");return i}function mr(i,e,t){const{replacer:s}=t,n=new Te(i);n.tag="tag:yaml.org,2002:pairs";let r=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof s=="function"&&(o=s.call(e,String(r++),o));let a,l;if(Array.isArray(o))if(o.length===2)a=o[0],l=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const c=Object.keys(o);if(c.length===1)a=c[0],l=o[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=o;n.items.push(yi(a,l,t))}return n}const vi={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:pr,createNode:mr};class Ye extends Te{constructor(){super(),this.add=V.prototype.add.bind(this),this.delete=V.prototype.delete.bind(this),this.get=V.prototype.get.bind(this),this.has=V.prototype.has.bind(this),this.set=V.prototype.set.bind(this),this.tag=Ye.tag}toJSON(e,t){if(!t)return super.toJSON(e);const s=new Map;t!=null&&t.onCreate&&t.onCreate(s);for(const n of this.items){let r,o;if(R(n)?(r=X(n.key,"",t),o=X(n.value,r,t)):r=X(n,"",t),s.has(r))throw new Error("Ordered maps must not include duplicate keys");s.set(r,o)}return s}static from(e,t,s){const n=mr(e,t,s),r=new this;return r.items=n.items,r}}Ye.tag="tag:yaml.org,2002:omap";const Si={collection:"seq",identify:i=>i instanceof Map,nodeClass:Ye,default:!1,tag:"tag:yaml.org,2002:omap",resolve(i,e){const t=pr(i,e),s=[];for(const{key:n}of t.items)L(n)&&(s.includes(n.value)?e(`Ordered maps must not include duplicate keys: ${n.value}`):s.push(n.value));return Object.assign(new Ye,t)},createNode:(i,e,t)=>Ye.from(i,e,t)};function gr({value:i,source:e},t){return e&&(i?yr:br).test.test(e)?e:i?t.options.trueStr:t.options.falseStr}const yr={identify:i=>i===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new O(!0),stringify:gr},br={identify:i=>i===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new O(!1),stringify:gr},gl={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:i=>i.slice(-3).toLowerCase()==="nan"?NaN:i[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:ce},yl={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:i=>parseFloat(i.replace(/_/g,"")),stringify(i){const e=Number(i.value);return isFinite(e)?e.toExponential():ce(i)}},bl={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(i){const e=new O(parseFloat(i.replace(/_/g,""))),t=i.indexOf(".");if(t!==-1){const s=i.substring(t+1).replace(/_/g,"");s[s.length-1]==="0"&&(e.minFractionDigits=s.length)}return e},stringify:ce},_t=i=>typeof i=="bigint"||Number.isInteger(i);function gs(i,e,t,{intAsBigInt:s}){const n=i[0];if((n==="-"||n==="+")&&(e+=1),i=i.substring(e).replace(/_/g,""),s){switch(t){case 2:i=`0b${i}`;break;case 8:i=`0o${i}`;break;case 16:i=`0x${i}`;break}const o=BigInt(i);return n==="-"?BigInt(-1)*o:o}const r=parseInt(i,t);return n==="-"?-1*r:r}function _i(i,e,t){const{value:s}=i;if(_t(s)){const n=s.toString(e);return s<0?"-"+t+n.substr(1):t+n}return ce(i)}const wl={identify:_t,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(i,e,t)=>gs(i,2,2,t),stringify:i=>_i(i,2,"0b")},kl={identify:_t,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(i,e,t)=>gs(i,1,8,t),stringify:i=>_i(i,8,"0")},vl={identify:_t,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(i,e,t)=>gs(i,0,10,t),stringify:ce},Sl={identify:_t,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(i,e,t)=>gs(i,2,16,t),stringify:i=>_i(i,16,"0x")};class Ve extends V{constructor(e){super(e),this.tag=Ve.tag}add(e){let t;R(e)?t=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?t=new x(e.key,null):t=new x(e,null),Le(this.items,t.key)||this.items.push(t)}get(e,t){const s=Le(this.items,e);return!t&&R(s)?L(s.key)?s.key.value:s.key:s}set(e,t){if(typeof t!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof t}`);const s=Le(this.items,e);s&&!t?this.items.splice(this.items.indexOf(s),1):!s&&t&&this.items.push(new x(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,s){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,s);throw new Error("Set items must all have null values")}static from(e,t,s){const{replacer:n}=s,r=new this(e);if(t&&Symbol.iterator in Object(t))for(let o of t)typeof n=="function"&&(o=n.call(t,o,o)),r.items.push(yi(o,null,s));return r}}Ve.tag="tag:yaml.org,2002:set";const Ai={collection:"map",identify:i=>i instanceof Set,nodeClass:Ve,default:!1,tag:"tag:yaml.org,2002:set",createNode:(i,e,t)=>Ve.from(i,e,t),resolve(i,e){if(Ze(i)){if(i.hasAllNullValues(!0))return Object.assign(new Ve,i);e("Set items must all have null values")}else e("Expected a mapping for this tag");return i}};function Ti(i,e){const t=i[0],s=t==="-"||t==="+"?i.substring(1):i,n=o=>e?BigInt(o):Number(o),r=s.replace(/_/g,"").split(":").reduce((o,a)=>o*n(60)+n(a),n(0));return t==="-"?n(-1)*r:r}function wr(i){let{value:e}=i,t=o=>o;if(typeof e=="bigint")t=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return ce(i);let s="";e<0&&(s="-",e*=t(-1));const n=t(60),r=[e%n];return e<60?r.unshift(0):(e=(e-r[0])/n,r.unshift(e%n),e>=60&&(e=(e-r[0])/n,r.unshift(e))),s+r.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const kr={identify:i=>typeof i=="bigint"||Number.isInteger(i),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(i,e,{intAsBigInt:t})=>Ti(i,t),stringify:wr},vr={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:i=>Ti(i,!1),stringify:wr},ys={identify:i=>i instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(i){const e=i.match(ys.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,t,s,n,r,o,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0;let c=Date.UTC(t,s-1,n,r||0,o||0,a||0,l);const h=e[8];if(h&&h!=="Z"){let u=Ti(h,!1);Math.abs(u)<30&&(u*=60),c-=6e4*u}return new Date(c)},stringify:({value:i})=>i.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")},nn=[tt,st,ds,ps,yr,br,wl,kl,vl,Sl,gl,yl,bl,ki,be,Si,vi,Ai,kr,vr,ys],rn=new Map([["core",hl],["failsafe",[tt,st,ds]],["json",ml],["yaml11",nn],["yaml-1.1",nn]]),on={binary:ki,bool:bi,float:cr,floatExp:lr,floatNaN:ar,floatTime:vr,int:hr,intHex:dr,intOct:ur,intTime:kr,map:tt,merge:be,null:ps,omap:Si,pairs:vi,seq:st,set:Ai,timestamp:ys},_l={"tag:yaml.org,2002:binary":ki,"tag:yaml.org,2002:merge":be,"tag:yaml.org,2002:omap":Si,"tag:yaml.org,2002:pairs":vi,"tag:yaml.org,2002:set":Ai,"tag:yaml.org,2002:timestamp":ys};function Rs(i,e,t){const s=rn.get(e);if(s&&!i)return t&&!s.includes(be)?s.concat(be):s.slice();let n=s;if(!n)if(Array.isArray(i))n=[];else{const r=Array.from(rn.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${r} or define customTags array`)}if(Array.isArray(i))for(const r of i)n=n.concat(r);else typeof i=="function"&&(n=i(n.slice()));return t&&(n=n.concat(be)),n.reduce((r,o)=>{const a=typeof o=="string"?on[o]:o;if(!a){const l=JSON.stringify(o),c=Object.keys(on).map(h=>JSON.stringify(h)).join(", ");throw new Error(`Unknown custom tag ${l}; use one of ${c}`)}return r.includes(a)||r.push(a),r},[])}const Al=(i,e)=>i.key<e.key?-1:i.key>e.key?1:0;class bs{constructor({compat:e,customTags:t,merge:s,resolveKnownTags:n,schema:r,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(e)?Rs(e,"compat"):e?Rs(null,e):null,this.name=typeof r=="string"&&r||"core",this.knownTags=n?_l:{},this.tags=Rs(t,this.name,s),this.toStringOptions=a??null,Object.defineProperty(this,_e,{value:tt}),Object.defineProperty(this,ge,{value:ds}),Object.defineProperty(this,Xe,{value:st}),this.sortMapEntries=typeof o=="function"?o:o===!0?Al:null}clone(){const e=Object.create(bs.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function Tl(i,e){var l;const t=[];let s=e.directives===!0;if(e.directives!==!1&&i.directives){const c=i.directives.toString(i);c?(t.push(c),s=!0):i.directives.docStart&&(s=!0)}s&&t.push("---");const n=sr(i,e),{commentString:r}=n.options;if(i.commentBefore){t.length!==1&&t.unshift("");const c=r(i.commentBefore);t.unshift(ye(c,""))}let o=!1,a=null;if(i.contents){if(P(i.contents)){if(i.contents.spaceBefore&&s&&t.push(""),i.contents.commentBefore){const u=r(i.contents.commentBefore);t.push(ye(u,""))}n.forceBlockIndent=!!i.comment,a=i.contents.comment}const c=a?void 0:()=>o=!0;let h=He(i.contents,n,()=>a=null,c);a&&(h+=Ie(h,"",r(a))),(h[0]==="|"||h[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${h}`:t.push(h)}else t.push(He(i.contents,n));if((l=i.directives)!=null&&l.docEnd)if(i.comment){const c=r(i.comment);c.includes(`
`)?(t.push("..."),t.push(ye(c,""))):t.push(`... ${c}`)}else t.push("...");else{let c=i.comment;c&&o&&(c=c.replace(/^\n+/,"")),c&&((!o||a)&&t[t.length-1]!==""&&t.push(""),t.push(ye(r(c),"")))}return t.join(`
`)+`
`}class it{constructor(e,t,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Z,{value:Hs});let n=null;typeof t=="function"||Array.isArray(t)?n=t:s===void 0&&t&&(s=t,t=void 0);const r=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},s);this.options=r;let{version:o}=r;s!=null&&s._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new K({version:o}),this.setSchema(o,s),this.contents=e===void 0?null:this.createNode(e,n,s)}clone(){const e=Object.create(it.prototype,{[Z]:{value:Hs}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=P(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){qe(this.contents)&&this.contents.add(e)}addIn(e,t){qe(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){const s=Gn(this);e.anchor=!t||s.has(t)?Xn(t||"a",s):t}return new cs(e.anchor)}createNode(e,t,s){let n;if(typeof t=="function")e=t.call({"":e},"",e),n=t;else if(Array.isArray(t)){const g=b=>typeof b=="number"||b instanceof String||b instanceof Number,k=t.filter(g).map(String);k.length>0&&(t=t.concat(k)),n=t}else s===void 0&&t&&(s=t,t=void 0);const{aliasDuplicateObjects:r,anchorPrefix:o,flow:a,keepUndefined:l,onTagObj:c,tag:h}=s??{},{onAnchor:u,setAnchors:d,sourceObjects:m}=Za(this,o||"a"),y={aliasDuplicateObjects:r??!0,keepUndefined:l??!1,onAnchor:u,onTagObj:c,replacer:n,schema:this.schema,sourceObjects:m},p=yt(e,h,y);return a&&$(p)&&(p.flow=!0),d(),p}createPair(e,t,s={}){const n=this.createNode(e,null,s),r=this.createNode(t,null,s);return new x(n,r)}delete(e){return qe(this.contents)?this.contents.delete(e):!1}deleteIn(e){return dt(e)?this.contents==null?!1:(this.contents=null,!0):qe(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return $(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return dt(e)?!t&&L(this.contents)?this.contents.value:this.contents:$(this.contents)?this.contents.getIn(e,t):void 0}has(e){return $(this.contents)?this.contents.has(e):!1}hasIn(e){return dt(e)?this.contents!==void 0:$(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=Gt(this.schema,[e],t):qe(this.contents)&&this.contents.set(e,t)}setIn(e,t){dt(e)?this.contents=t:this.contents==null?this.contents=Gt(this.schema,Array.from(e),t):qe(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let s;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new K({version:"1.1"}),s={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new K({version:e}),s={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const n=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${n}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(s)this.schema=new bs(Object.assign(s,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:s,maxAliasCount:n,onAnchor:r,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!e,mapAsMap:s===!0,mapKeyWarned:!1,maxAliasCount:typeof n=="number"?n:100},l=X(this.contents,t??"",a);if(typeof r=="function")for(const{count:c,res:h}of a.anchors.values())r(h,c);return typeof o=="function"?Ke(o,{"":l},"",l):l}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return Tl(this,e)}}function qe(i){if($(i))return!0;throw new Error("Expected a YAML collection as document contents")}class Ei extends Error{constructor(e,t,s,n){super(),this.name=e,this.code=s,this.message=n,this.pos=t}}class Be extends Ei{constructor(e,t,s){super("YAMLParseError",e,t,s)}}class Sr extends Ei{constructor(e,t,s){super("YAMLWarning",e,t,s)}}const Zt=(i,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(a=>e.linePos(a));const{line:s,col:n}=t.linePos[0];t.message+=` at line ${s}, column ${n}`;let r=n-1,o=i.substring(e.lineStarts[s-1],e.lineStarts[s]).replace(/[\n\r]+$/,"");if(r>=60&&o.length>80){const a=Math.min(r-39,o.length-79);o="…"+o.substring(a),r-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),s>1&&/^ *$/.test(o.substring(0,r))){let a=i.substring(e.lineStarts[s-2],e.lineStarts[s-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const l=t.linePos[1];l&&l.line===s&&l.col>n&&(a=Math.max(1,Math.min(l.col-n,80-r)));const c=" ".repeat(r)+"^".repeat(a);t.message+=`:

${o}
${c}
`}};function Qe(i,{flow:e,indicator:t,next:s,offset:n,onError:r,parentIndent:o,startOnNewline:a}){let l=!1,c=a,h=a,u="",d="",m=!1,y=!1,p=null,g=null,k=null,b=null,v=null,_=null,T=null;for(const A of i)switch(y&&(A.type!=="space"&&A.type!=="newline"&&A.type!=="comma"&&r(A.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),y=!1),p&&(c&&A.type!=="comment"&&A.type!=="newline"&&r(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),p=null),A.type){case"space":!e&&(t!=="doc-start"||(s==null?void 0:s.type)!=="flow-collection")&&A.source.includes("	")&&(p=A),h=!0;break;case"comment":{h||r(A,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const B=A.source.substring(1)||" ";u?u+=d+B:u=B,d="",c=!1;break}case"newline":c?u?u+=A.source:l=!0:d+=A.source,c=!0,m=!0,(g||k)&&(b=A),h=!0;break;case"anchor":g&&r(A,"MULTIPLE_ANCHORS","A node can have at most one anchor"),A.source.endsWith(":")&&r(A.offset+A.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),g=A,T===null&&(T=A.offset),c=!1,h=!1,y=!0;break;case"tag":{k&&r(A,"MULTIPLE_TAGS","A node can have at most one tag"),k=A,T===null&&(T=A.offset),c=!1,h=!1,y=!0;break}case t:(g||k)&&r(A,"BAD_PROP_ORDER",`Anchors and tags must be after the ${A.source} indicator`),_&&r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.source} in ${e??"collection"}`),_=A,c=t==="seq-item-ind"||t==="explicit-key-ind",h=!1;break;case"comma":if(e){v&&r(A,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),v=A,c=!1,h=!1;break}default:r(A,"UNEXPECTED_TOKEN",`Unexpected ${A.type} token`),c=!1,h=!1}const S=i[i.length-1],E=S?S.offset+S.source.length:n;return y&&s&&s.type!=="space"&&s.type!=="newline"&&s.type!=="comma"&&(s.type!=="scalar"||s.source!=="")&&r(s.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p&&(c&&p.indent<=o||(s==null?void 0:s.type)==="block-map"||(s==null?void 0:s.type)==="block-seq")&&r(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:v,found:_,spaceBefore:l,comment:u,hasNewline:m,anchor:g,tag:k,newlineAfterProp:b,end:E,start:T??E}}function bt(i){if(!i)return null;switch(i.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(i.source.includes(`
`))return!0;if(i.end){for(const e of i.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of i.items){for(const t of e.start)if(t.type==="newline")return!0;if(e.sep){for(const t of e.sep)if(t.type==="newline")return!0}if(bt(e.key)||bt(e.value))return!0}return!1;default:return!0}}function Zs(i,e,t){if((e==null?void 0:e.type)==="flow-collection"){const s=e.end[0];s.indent===i&&(s.source==="]"||s.source==="}")&&bt(e)&&t(s,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function _r(i,e,t){const{uniqueKeys:s}=i.options;if(s===!1)return!1;const n=typeof s=="function"?s:(r,o)=>r===o||L(r)&&L(o)&&r.value===o.value;return e.some(r=>n(r.key,t))}const an="All mapping items must start at the same column";function El({composeNode:i,composeEmptyNode:e},t,s,n,r){var h;const o=(r==null?void 0:r.nodeClass)??V,a=new o(t.schema);t.atRoot&&(t.atRoot=!1);let l=s.offset,c=null;for(const u of s.items){const{start:d,key:m,sep:y,value:p}=u,g=Qe(d,{indicator:"explicit-key-ind",next:m??(y==null?void 0:y[0]),offset:l,onError:n,parentIndent:s.indent,startOnNewline:!0}),k=!g.found;if(k){if(m&&(m.type==="block-seq"?n(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in m&&m.indent!==s.indent&&n(l,"BAD_INDENT",an)),!g.anchor&&!g.tag&&!y){c=g.end,g.comment&&(a.comment?a.comment+=`
`+g.comment:a.comment=g.comment);continue}(g.newlineAfterProp||bt(m))&&n(m??d[d.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((h=g.found)==null?void 0:h.indent)!==s.indent&&n(l,"BAD_INDENT",an);t.atKey=!0;const b=g.end,v=m?i(t,m,g,n):e(t,b,d,null,g,n);t.schema.compat&&Zs(s.indent,m,n),t.atKey=!1,_r(t,a.items,v)&&n(b,"DUPLICATE_KEY","Map keys must be unique");const _=Qe(y??[],{indicator:"map-value-ind",next:p,offset:v.range[2],onError:n,parentIndent:s.indent,startOnNewline:!m||m.type==="block-scalar"});if(l=_.end,_.found){k&&((p==null?void 0:p.type)==="block-map"&&!_.hasNewline&&n(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&g.start<_.found.offset-1024&&n(v.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const T=p?i(t,p,_,n):e(t,l,y,null,_,n);t.schema.compat&&Zs(s.indent,p,n),l=T.range[2];const S=new x(v,T);t.options.keepSourceTokens&&(S.srcToken=u),a.items.push(S)}else{k&&n(v.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),_.comment&&(v.comment?v.comment+=`
`+_.comment:v.comment=_.comment);const T=new x(v);t.options.keepSourceTokens&&(T.srcToken=u),a.items.push(T)}}return c&&c<l&&n(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[s.offset,l,c??l],a}function Ol({composeNode:i,composeEmptyNode:e},t,s,n,r){const o=(r==null?void 0:r.nodeClass)??Te,a=new o(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let l=s.offset,c=null;for(const{start:h,value:u}of s.items){const d=Qe(h,{indicator:"seq-item-ind",next:u,offset:l,onError:n,parentIndent:s.indent,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||u)u&&u.type==="block-seq"?n(d.end,"BAD_INDENT","All sequence items must start at the same column"):n(l,"MISSING_CHAR","Sequence item without - indicator");else{c=d.end,d.comment&&(a.comment=d.comment);continue}const m=u?i(t,u,d,n):e(t,d.end,h,null,d,n);t.schema.compat&&Zs(s.indent,u,n),l=m.range[2],a.items.push(m)}return a.range=[s.offset,l,c??l],a}function At(i,e,t,s){let n="";if(i){let r=!1,o="";for(const a of i){const{source:l,type:c}=a;switch(c){case"space":r=!0;break;case"comment":{t&&!r&&s(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=l.substring(1)||" ";n?n+=o+h:n=h,o="";break}case"newline":n&&(o+=l),r=!0;break;default:s(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=l.length}}return{comment:n,offset:e}}const $s="Block collections are not allowed within flow collections",Ps=i=>i&&(i.type==="block-map"||i.type==="block-seq");function Nl({composeNode:i,composeEmptyNode:e},t,s,n,r){const o=s.start.source==="{",a=o?"flow map":"flow sequence",l=(r==null?void 0:r.nodeClass)??(o?V:Te),c=new l(t.schema);c.flow=!0;const h=t.atRoot;h&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let u=s.offset+s.start.source.length;for(let g=0;g<s.items.length;++g){const k=s.items[g],{start:b,key:v,sep:_,value:T}=k,S=Qe(b,{flow:a,indicator:"explicit-key-ind",next:v??(_==null?void 0:_[0]),offset:u,onError:n,parentIndent:s.indent,startOnNewline:!1});if(!S.found){if(!S.anchor&&!S.tag&&!_&&!T){g===0&&S.comma?n(S.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):g<s.items.length-1&&n(S.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),S.comment&&(c.comment?c.comment+=`
`+S.comment:c.comment=S.comment),u=S.end;continue}!o&&t.options.strict&&bt(v)&&n(v,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(g===0)S.comma&&n(S.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(S.comma||n(S.start,"MISSING_CHAR",`Missing , between ${a} items`),S.comment){let E="";e:for(const A of b)switch(A.type){case"comma":case"space":break;case"comment":E=A.source.substring(1);break e;default:break e}if(E){let A=c.items[c.items.length-1];R(A)&&(A=A.value??A.key),A.comment?A.comment+=`
`+E:A.comment=E,S.comment=S.comment.substring(E.length+1)}}if(!o&&!_&&!S.found){const E=T?i(t,T,S,n):e(t,S.end,_,null,S,n);c.items.push(E),u=E.range[2],Ps(T)&&n(E.range,"BLOCK_IN_FLOW",$s)}else{t.atKey=!0;const E=S.end,A=v?i(t,v,S,n):e(t,E,b,null,S,n);Ps(v)&&n(A.range,"BLOCK_IN_FLOW",$s),t.atKey=!1;const B=Qe(_??[],{flow:a,indicator:"map-value-ind",next:T,offset:A.range[2],onError:n,parentIndent:s.indent,startOnNewline:!1});if(B.found){if(!o&&!S.found&&t.options.strict){if(_)for(const I of _){if(I===B.found)break;if(I.type==="newline"){n(I,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}S.start<B.found.offset-1024&&n(B.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else T&&("source"in T&&T.source&&T.source[0]===":"?n(T,"MISSING_CHAR",`Missing space after : in ${a}`):n(B.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const j=T?i(t,T,B,n):B.found?e(t,B.end,_,null,B,n):null;j?Ps(T)&&n(j.range,"BLOCK_IN_FLOW",$s):B.comment&&(A.comment?A.comment+=`
`+B.comment:A.comment=B.comment);const J=new x(A,j);if(t.options.keepSourceTokens&&(J.srcToken=k),o){const I=c;_r(t,I.items,A)&&n(E,"DUPLICATE_KEY","Map keys must be unique"),I.items.push(J)}else{const I=new V(t.schema);I.flow=!0,I.items.push(J);const Ee=(j??A).range;I.range=[A.range[0],Ee[1],Ee[2]],c.items.push(I)}u=j?j.range[2]:B.end}}const d=o?"}":"]",[m,...y]=s.end;let p=u;if(m&&m.source===d)p=m.offset+m.source.length;else{const g=a[0].toUpperCase()+a.substring(1),k=h?`${g} must end with a ${d}`:`${g} in block collection must be sufficiently indented and end with a ${d}`;n(u,h?"MISSING_CHAR":"BAD_INDENT",k),m&&m.source.length!==1&&y.unshift(m)}if(y.length>0){const g=At(y,p,t.options.strict,n);g.comment&&(c.comment?c.comment+=`
`+g.comment:c.comment=g.comment),c.range=[s.offset,p,g.offset]}else c.range=[s.offset,p,p];return c}function Ds(i,e,t,s,n,r){const o=t.type==="block-map"?El(i,e,t,s,r):t.type==="block-seq"?Ol(i,e,t,s,r):Nl(i,e,t,s,r),a=o.constructor;return n==="!"||n===a.tagName?(o.tag=a.tagName,o):(n&&(o.tag=n),o)}function Cl(i,e,t,s,n){var d;const r=s.tag,o=r?e.directives.tagName(r.source,m=>n(r,"TAG_RESOLVE_FAILED",m)):null;if(t.type==="block-seq"){const{anchor:m,newlineAfterProp:y}=s,p=m&&r?m.offset>r.offset?m:r:m??r;p&&(!y||y.offset<p.offset)&&n(p,"MISSING_CHAR","Missing newline after block sequence props")}const a=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!r||!o||o==="!"||o===V.tagName&&a==="map"||o===Te.tagName&&a==="seq")return Ds(i,e,t,n,o);let l=e.schema.tags.find(m=>m.tag===o&&m.collection===a);if(!l){const m=e.schema.knownTags[o];if(m&&m.collection===a)e.schema.tags.push(Object.assign({},m,{default:!1})),l=m;else return m!=null&&m.collection?n(r,"BAD_COLLECTION_TYPE",`${m.tag} used for ${a} collection, but expects ${m.collection}`,!0):n(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),Ds(i,e,t,n,o)}const c=Ds(i,e,t,n,o,l),h=((d=l.resolve)==null?void 0:d.call(l,c,m=>n(r,"TAG_RESOLVE_FAILED",m),e.options))??c,u=P(h)?h:new O(h);return u.range=c.range,u.tag=o,l!=null&&l.format&&(u.format=l.format),u}function Ar(i,e,t){const s=e.offset,n=Il(e,i.options.strict,t);if(!n)return{value:"",type:null,comment:"",range:[s,s,s]};const r=n.mode===">"?O.BLOCK_FOLDED:O.BLOCK_LITERAL,o=e.source?Ll(e.source):[];let a=o.length;for(let p=o.length-1;p>=0;--p){const g=o[p][1];if(g===""||g==="\r")a=p;else break}if(a===0){const p=n.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let g=s+n.length;return e.source&&(g+=e.source.length),{value:p,type:r,comment:n.comment,range:[s,g,g]}}let l=e.indent+n.indent,c=e.offset+n.length,h=0;for(let p=0;p<a;++p){const[g,k]=o[p];if(k===""||k==="\r")n.indent===0&&g.length>l&&(l=g.length);else{g.length<l&&t(c+g.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),n.indent===0&&(l=g.length),h=p,l===0&&!i.atRoot&&t(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=g.length+k.length+1}for(let p=o.length-1;p>=a;--p)o[p][0].length>l&&(a=p+1);let u="",d="",m=!1;for(let p=0;p<h;++p)u+=o[p][0].slice(l)+`
`;for(let p=h;p<a;++p){let[g,k]=o[p];c+=g.length+k.length+1;const b=k[k.length-1]==="\r";if(b&&(k=k.slice(0,-1)),k&&g.length<l){const _=`Block scalar lines must not be less indented than their ${n.indent?"explicit indentation indicator":"first line"}`;t(c-k.length-(b?2:1),"BAD_INDENT",_),g=""}r===O.BLOCK_LITERAL?(u+=d+g.slice(l)+k,d=`
`):g.length>l||k[0]==="	"?(d===" "?d=`
`:!m&&d===`
`&&(d=`

`),u+=d+g.slice(l)+k,d=`
`,m=!0):k===""?d===`
`?u+=`
`:d=`
`:(u+=d+k,d=" ",m=!1)}switch(n.chomp){case"-":break;case"+":for(let p=a;p<o.length;++p)u+=`
`+o[p][0].slice(l);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}const y=s+n.length+e.source.length;return{value:u,type:r,comment:n.comment,range:[s,y,y]}}function Il({offset:i,props:e},t,s){if(e[0].type!=="block-scalar-header")return s(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:n}=e[0],r=n[0];let o=0,a="",l=-1;for(let d=1;d<n.length;++d){const m=n[d];if(!a&&(m==="-"||m==="+"))a=m;else{const y=Number(m);!o&&y?o=y:l===-1&&(l=i+d)}}l!==-1&&s(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${n}`);let c=!1,h="",u=n.length;for(let d=1;d<e.length;++d){const m=e[d];switch(m.type){case"space":c=!0;case"newline":u+=m.source.length;break;case"comment":t&&!c&&s(m,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=m.source.length,h=m.source.substring(1);break;case"error":s(m,"UNEXPECTED_TOKEN",m.message),u+=m.source.length;break;default:{const y=`Unexpected token in block scalar header: ${m.type}`;s(m,"UNEXPECTED_TOKEN",y);const p=m.source;p&&typeof p=="string"&&(u+=p.length)}}}return{mode:r,indent:o,chomp:a,comment:h,length:u}}function Ll(i){const e=i.split(/\n( *)/),t=e[0],s=t.match(/^( *)/),r=[s!=null&&s[1]?[s[1],t.slice(s[1].length)]:["",t]];for(let o=1;o<e.length;o+=2)r.push([e[o],e[o+1]]);return r}function Tr(i,e,t){const{offset:s,type:n,source:r,end:o}=i;let a,l;const c=(d,m,y)=>t(s+d,m,y);switch(n){case"scalar":a=O.PLAIN,l=Bl(r,c);break;case"single-quoted-scalar":a=O.QUOTE_SINGLE,l=Rl(r,c);break;case"double-quoted-scalar":a=O.QUOTE_DOUBLE,l=$l(r,c);break;default:return t(i,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${n}`),{value:"",type:null,comment:"",range:[s,s+r.length,s+r.length]}}const h=s+r.length,u=At(o,h,e,t);return{value:l,type:a,comment:u.comment,range:[s,h,u.offset]}}function Bl(i,e){let t="";switch(i[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${i[0]}`;break}case"@":case"`":{t=`reserved character ${i[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),Er(i)}function Rl(i,e){return(i[i.length-1]!=="'"||i.length===1)&&e(i.length,"MISSING_CHAR","Missing closing 'quote"),Er(i.slice(1,-1)).replace(/''/g,"'")}function Er(i){let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let s=e.exec(i);if(!s)return i;let n=s[1],r=" ",o=e.lastIndex;for(t.lastIndex=o;s=t.exec(i);)s[1]===""?r===`
`?n+=r:r=`
`:(n+=r+s[1],r=" "),o=t.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,s=a.exec(i),n+r+((s==null?void 0:s[1])??"")}function $l(i,e){let t="";for(let s=1;s<i.length-1;++s){const n=i[s];if(!(n==="\r"&&i[s+1]===`
`))if(n===`
`){const{fold:r,offset:o}=Pl(i,s);t+=r,s=o}else if(n==="\\"){let r=i[++s];const o=Dl[r];if(o)t+=o;else if(r===`
`)for(r=i[s+1];r===" "||r==="	";)r=i[++s+1];else if(r==="\r"&&i[s+1]===`
`)for(r=i[++s+1];r===" "||r==="	";)r=i[++s+1];else if(r==="x"||r==="u"||r==="U"){const a={x:2,u:4,U:8}[r];t+=ql(i,s+1,a,e),s+=a}else{const a=i.substr(s-1,2);e(s-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),t+=a}}else if(n===" "||n==="	"){const r=s;let o=i[s+1];for(;o===" "||o==="	";)o=i[++s+1];o!==`
`&&!(o==="\r"&&i[s+2]===`
`)&&(t+=s>r?i.slice(r,s+1):n)}else t+=n}return(i[i.length-1]!=='"'||i.length===1)&&e(i.length,"MISSING_CHAR",'Missing closing "quote'),t}function Pl(i,e){let t="",s=i[e+1];for(;(s===" "||s==="	"||s===`
`||s==="\r")&&!(s==="\r"&&i[e+2]!==`
`);)s===`
`&&(t+=`
`),e+=1,s=i[e+1];return t||(t=" "),{fold:t,offset:e}}const Dl={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function ql(i,e,t,s){const n=i.substr(e,t),o=n.length===t&&/^[0-9a-fA-F]+$/.test(n)?parseInt(n,16):NaN;if(isNaN(o)){const a=i.substr(e-2,t+2);return s(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function Or(i,e,t,s){const{value:n,type:r,comment:o,range:a}=e.type==="block-scalar"?Ar(i,e,s):Tr(e,i.options.strict,s),l=t?i.directives.tagName(t.source,u=>s(t,"TAG_RESOLVE_FAILED",u)):null;let c;i.options.stringKeys&&i.atKey?c=i.schema[ge]:l?c=Fl(i.schema,n,l,t,s):e.type==="scalar"?c=Ml(i,n,e,s):c=i.schema[ge];let h;try{const u=c.resolve(n,d=>s(t??e,"TAG_RESOLVE_FAILED",d),i.options);h=L(u)?u:new O(u)}catch(u){const d=u instanceof Error?u.message:String(u);s(t??e,"TAG_RESOLVE_FAILED",d),h=new O(n)}return h.range=a,h.source=n,r&&(h.type=r),l&&(h.tag=l),c.format&&(h.format=c.format),o&&(h.comment=o),h}function Fl(i,e,t,s,n){var a;if(t==="!")return i[ge];const r=[];for(const l of i.tags)if(!l.collection&&l.tag===t)if(l.default&&l.test)r.push(l);else return l;for(const l of r)if((a=l.test)!=null&&a.test(e))return l;const o=i.knownTags[t];return o&&!o.collection?(i.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(n(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),i[ge])}function Ml({atKey:i,directives:e,schema:t},s,n,r){const o=t.tags.find(a=>{var l;return(a.default===!0||i&&a.default==="key")&&((l=a.test)==null?void 0:l.test(s))})||t[ge];if(t.compat){const a=t.compat.find(l=>{var c;return l.default&&((c=l.test)==null?void 0:c.test(s))})??t[ge];if(o.tag!==a.tag){const l=e.tagString(o.tag),c=e.tagString(a.tag),h=`Value may be parsed as either ${l} or ${c}`;r(n,"TAG_RESOLVE_FAILED",h,!0)}}return o}function jl(i,e,t){if(e){t===null&&(t=e.length);for(let s=t-1;s>=0;--s){let n=e[s];switch(n.type){case"space":case"comment":case"newline":i-=n.source.length;continue}for(n=e[++s];(n==null?void 0:n.type)==="space";)i+=n.source.length,n=e[++s];break}}return i}const xl={composeNode:Nr,composeEmptyNode:Oi};function Nr(i,e,t,s){const n=i.atKey,{spaceBefore:r,comment:o,anchor:a,tag:l}=t;let c,h=!0;switch(e.type){case"alias":c=Kl(i,e,s),(a||l)&&s(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=Or(i,e,l,s),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Cl(xl,i,e,t,s),a&&(c.anchor=a.source.substring(1));break;default:{const u=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;s(e,"UNEXPECTED_TOKEN",u),c=Oi(i,e.offset,void 0,null,t,s),h=!1}}return a&&c.anchor===""&&s(a,"BAD_ALIAS","Anchor cannot be an empty string"),n&&i.options.stringKeys&&(!L(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&s(l??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),r&&(c.spaceBefore=!0),o&&(e.type==="scalar"&&e.source===""?c.comment=o:c.commentBefore=o),i.options.keepSourceTokens&&h&&(c.srcToken=e),c}function Oi(i,e,t,s,{spaceBefore:n,comment:r,anchor:o,tag:a,end:l},c){const h={type:"scalar",offset:jl(e,t,s),indent:-1,source:""},u=Or(i,h,a,c);return o&&(u.anchor=o.source.substring(1),u.anchor===""&&c(o,"BAD_ALIAS","Anchor cannot be an empty string")),n&&(u.spaceBefore=!0),r&&(u.comment=r,u.range[2]=l),u}function Kl({options:i},{offset:e,source:t,end:s},n){const r=new cs(t.substring(1));r.source===""&&n(e,"BAD_ALIAS","Alias cannot be an empty string"),r.source.endsWith(":")&&n(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+t.length,a=At(s,o,i.strict,n);return r.range=[e,o,a.offset],a.comment&&(r.comment=a.comment),r}function Ul(i,e,{offset:t,start:s,value:n,end:r},o){const a=Object.assign({_directives:e},i),l=new it(void 0,a),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},h=Qe(s,{indicator:"doc-start",next:n??(r==null?void 0:r[0]),offset:t,onError:o,parentIndent:0,startOnNewline:!0});h.found&&(l.directives.docStart=!0,n&&(n.type==="block-map"||n.type==="block-seq")&&!h.hasNewline&&o(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=n?Nr(c,n,h,o):Oi(c,h.end,s,null,h,o);const u=l.contents.range[2],d=At(r,u,!1,o);return d.comment&&(l.comment=d.comment),l.range=[t,u,d.offset],l}function at(i){if(typeof i=="number")return[i,i+1];if(Array.isArray(i))return i.length===2?i:[i[0],i[1]];const{offset:e,source:t}=i;return[e,e+(typeof t=="string"?t.length:1)]}function ln(i){var n;let e="",t=!1,s=!1;for(let r=0;r<i.length;++r){const o=i[r];switch(o[0]){case"#":e+=(e===""?"":s?`

`:`
`)+(o.substring(1)||" "),t=!0,s=!1;break;case"%":((n=i[r+1])==null?void 0:n[0])!=="#"&&(r+=1),t=!1;break;default:t||(s=!0),t=!1}}return{comment:e,afterEmptyLine:s}}class Ni{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,s,n,r)=>{const o=at(t);r?this.warnings.push(new Sr(o,s,n)):this.errors.push(new Be(o,s,n))},this.directives=new K({version:e.version||"1.2"}),this.options=e}decorate(e,t){const{comment:s,afterEmptyLine:n}=ln(this.prelude);if(s){const r=e.contents;if(t)e.comment=e.comment?`${e.comment}
${s}`:s;else if(n||e.directives.docStart||!r)e.commentBefore=s;else if($(r)&&!r.flow&&r.items.length>0){let o=r.items[0];R(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${s}
${a}`:s}else{const o=r.commentBefore;r.commentBefore=o?`${s}
${o}`:s}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:ln(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,s=-1){for(const n of e)yield*this.next(n);yield*this.end(t,s)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,s,n)=>{const r=at(e);r[0]+=t,this.onError(r,"BAD_DIRECTIVE",s,n)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const t=Ul(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new Be(at(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const s="Unexpected doc-end without preceding document";this.errors.push(new Be(at(e),"UNEXPECTED_TOKEN",s));break}this.doc.directives.docEnd=!0;const t=At(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){const s=this.doc.comment;this.doc.comment=s?`${s}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new Be(at(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const s=Object.assign({_directives:this.directives},this.options),n=new it(void 0,s);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),n.range=[0,t,t],this.decorate(n,!1),yield n}}}function Wl(i,e=!0,t){if(i){const s=(n,r,o)=>{const a=typeof n=="number"?n:Array.isArray(n)?n[0]:n.offset;if(t)t(a,r,o);else throw new Be([a,a+1],r,o)};switch(i.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Tr(i,e,s);case"block-scalar":return Ar({options:{strict:e}},i,s)}}return null}function Yl(i,e){const{implicitKey:t=!1,indent:s,inFlow:n=!1,offset:r=-1,type:o="PLAIN"}=e,a=St({type:o,value:i},{implicitKey:t,indent:s>0?" ".repeat(s):"",inFlow:n,options:{blockQuote:!0,lineWidth:-1}}),l=e.end??[{type:"newline",offset:-1,indent:s,source:`
`}];switch(a[0]){case"|":case">":{const c=a.indexOf(`
`),h=a.substring(0,c),u=a.substring(c+1)+`
`,d=[{type:"block-scalar-header",offset:r,indent:s,source:h}];return Cr(d,l)||d.push({type:"newline",offset:-1,indent:s,source:`
`}),{type:"block-scalar",offset:r,indent:s,props:d,source:u}}case'"':return{type:"double-quoted-scalar",offset:r,indent:s,source:a,end:l};case"'":return{type:"single-quoted-scalar",offset:r,indent:s,source:a,end:l};default:return{type:"scalar",offset:r,indent:s,source:a,end:l}}}function Vl(i,e,t={}){let{afterKey:s=!1,implicitKey:n=!1,inFlow:r=!1,type:o}=t,a="indent"in i?i.indent:null;if(s&&typeof a=="number"&&(a+=2),!o)switch(i.type){case"single-quoted-scalar":o="QUOTE_SINGLE";break;case"double-quoted-scalar":o="QUOTE_DOUBLE";break;case"block-scalar":{const c=i.props[0];if(c.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o=c.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:o="PLAIN"}const l=St({type:o,value:e},{implicitKey:n||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:r,options:{blockQuote:!0,lineWidth:-1}});switch(l[0]){case"|":case">":zl(i,l);break;case'"':qs(i,l,"double-quoted-scalar");break;case"'":qs(i,l,"single-quoted-scalar");break;default:qs(i,l,"scalar")}}function zl(i,e){const t=e.indexOf(`
`),s=e.substring(0,t),n=e.substring(t+1)+`
`;if(i.type==="block-scalar"){const r=i.props[0];if(r.type!=="block-scalar-header")throw new Error("Invalid block scalar header");r.source=s,i.source=n}else{const{offset:r}=i,o="indent"in i?i.indent:-1,a=[{type:"block-scalar-header",offset:r,indent:o,source:s}];Cr(a,"end"in i?i.end:void 0)||a.push({type:"newline",offset:-1,indent:o,source:`
`});for(const l of Object.keys(i))l!=="type"&&l!=="offset"&&delete i[l];Object.assign(i,{type:"block-scalar",indent:o,props:a,source:n})}}function Cr(i,e){if(e)for(const t of e)switch(t.type){case"space":case"comment":i.push(t);break;case"newline":return i.push(t),!0}return!1}function qs(i,e,t){switch(i.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":i.type=t,i.source=e;break;case"block-scalar":{const s=i.props.slice(1);let n=e.length;i.props[0].type==="block-scalar-header"&&(n-=i.props[0].source.length);for(const r of s)r.offset+=n;delete i.props,Object.assign(i,{type:t,source:e,end:s});break}case"block-map":case"block-seq":{const n={type:"newline",offset:i.offset+e.length,indent:i.indent,source:`
`};delete i.items,Object.assign(i,{type:t,source:e,end:[n]});break}default:{const s="indent"in i?i.indent:-1,n="end"in i&&Array.isArray(i.end)?i.end.filter(r=>r.type==="space"||r.type==="comment"||r.type==="newline"):[];for(const r of Object.keys(i))r!=="type"&&r!=="offset"&&delete i[r];Object.assign(i,{type:t,indent:s,source:e,end:n})}}}const Jl=i=>"type"in i?es(i):Wt(i);function es(i){switch(i.type){case"block-scalar":{let e="";for(const t of i.props)e+=es(t);return e+i.source}case"block-map":case"block-seq":{let e="";for(const t of i.items)e+=Wt(t);return e}case"flow-collection":{let e=i.start.source;for(const t of i.items)e+=Wt(t);for(const t of i.end)e+=t.source;return e}case"document":{let e=Wt(i);if(i.end)for(const t of i.end)e+=t.source;return e}default:{let e=i.source;if("end"in i&&i.end)for(const t of i.end)e+=t.source;return e}}}function Wt({start:i,key:e,sep:t,value:s}){let n="";for(const r of i)n+=r.source;if(e&&(n+=es(e)),t)for(const r of t)n+=r.source;return s&&(n+=es(s)),n}const ei=Symbol("break visit"),Hl=Symbol("skip children"),Ir=Symbol("remove item");function Re(i,e){"type"in i&&i.type==="document"&&(i={start:i.start,value:i.value}),Lr(Object.freeze([]),i,e)}Re.BREAK=ei;Re.SKIP=Hl;Re.REMOVE=Ir;Re.itemAtPath=(i,e)=>{let t=i;for(const[s,n]of e){const r=t==null?void 0:t[s];if(r&&"items"in r)t=r.items[n];else return}return t};Re.parentCollection=(i,e)=>{const t=Re.itemAtPath(i,e.slice(0,-1)),s=e[e.length-1][0],n=t==null?void 0:t[s];if(n&&"items"in n)return n;throw new Error("Parent collection not found")};function Lr(i,e,t){let s=t(e,i);if(typeof s=="symbol")return s;for(const n of["key","value"]){const r=e[n];if(r&&"items"in r){for(let o=0;o<r.items.length;++o){const a=Lr(Object.freeze(i.concat([[n,o]])),r.items[o],t);if(typeof a=="number")o=a-1;else{if(a===ei)return ei;a===Ir&&(r.items.splice(o,1),o-=1)}}typeof s=="function"&&n==="key"&&(s=s(e,i))}}return typeof s=="function"?s(e,i):s}const ws="\uFEFF",ks="",vs="",wt="",Ql=i=>!!i&&"items"in i,Gl=i=>!!i&&(i.type==="scalar"||i.type==="single-quoted-scalar"||i.type==="double-quoted-scalar"||i.type==="block-scalar");function Xl(i){switch(i){case ws:return"<BOM>";case ks:return"<DOC>";case vs:return"<FLOW_END>";case wt:return"<SCALAR>";default:return JSON.stringify(i)}}function Br(i){switch(i){case ws:return"byte-order-mark";case ks:return"doc-mode";case vs:return"flow-error-end";case wt:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(i[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const Zl=Object.freeze(Object.defineProperty({__proto__:null,BOM:ws,DOCUMENT:ks,FLOW_END:vs,SCALAR:wt,createScalarToken:Yl,isCollection:Ql,isScalar:Gl,prettyToken:Xl,resolveAsScalar:Wl,setScalarValue:Vl,stringify:Jl,tokenType:Br,visit:Re},Symbol.toStringTag,{value:"Module"}));function se(i){switch(i){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const cn=new Set("0123456789ABCDEFabcdef"),ec=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),$t=new Set(",[]{}"),tc=new Set(` ,[]{}
\r	`),Fs=i=>!i||tc.has(i);class Rr{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let s=this.next??"stream";for(;s&&(t||this.hasChars(1));)s=yield*this.parseNext(s)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let s=0;for(;t===" ";)t=this.buffer[++s+e];if(t==="\r"){const n=this.buffer[s+e+1];if(n===`
`||!n&&!this.atEnd)return e+s+1}return t===`
`||s>=this.indentNext||!t&&!this.atEnd?e+s:-1}if(t==="-"||t==="."){const s=this.buffer.substr(e,3);if((s==="---"||s==="...")&&se(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===ws&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let t=e.length,s=e.indexOf("#");for(;s!==-1;){const r=e[s-1];if(r===" "||r==="	"){t=s-1;break}else s=e.indexOf("#",s+1)}for(;;){const r=e[t-1];if(r===" "||r==="	")t-=1;else break}const n=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-n),this.pushNewline(),"stream"}if(this.atLineEnd()){const t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield ks,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const t=this.peek(3);if((t==="---"||t==="...")&&se(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,t==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!se(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&se(t)){const s=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=s,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Fs),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=yield*this.parseBlockScalarHeader(),t+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,s=-1;do e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=s=t):t=0,t+=yield*this.pushSpaces(!0);while(e+t>0);const n=this.getLine();if(n===null)return this.setNext("flow");if((s!==-1&&s<this.indentNext&&n[0]!=="#"||s===0&&(n.startsWith("---")||n.startsWith("..."))&&se(n[3]))&&!(s===this.indentNext-1&&this.flowLevel===1&&(n[0]==="]"||n[0]==="}")))return this.flowLevel=0,yield vs,yield*this.parseLineStart();let r=0;for(;n[r]===",";)r+=yield*this.pushCount(1),r+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(r+=yield*this.pushIndicators(),n[r]){case void 0:return"flow";case"#":return yield*this.pushCount(n.length-r),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Fs),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||se(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let r=0;for(;this.buffer[t-1-r]==="\\";)r+=1;if(r%2===0)break;t=this.buffer.indexOf('"',t+1)}const s=this.buffer.substring(0,t);let n=s.indexOf(`
`,this.pos);if(n!==-1){for(;n!==-1;){const r=this.continueScalar(n+1);if(r===-1)break;n=s.indexOf(`
`,r)}n!==-1&&(t=n-(s[n-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*this.pushUntil(t=>se(t)||t==="#")}*parseBlockScalar(){let e=this.pos-1,t=0,s;e:for(let r=this.pos;s=this.buffer[r];++r)switch(s){case" ":t+=1;break;case`
`:e=r,t=0;break;case"\r":{const o=this.buffer[r+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!s&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const r=this.continueScalar(e+1);if(r===-1)break;e=this.buffer.indexOf(`
`,r)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let n=e+1;for(s=this.buffer[n];s===" ";)s=this.buffer[++n];if(s==="	"){for(;s==="	"||s===" "||s==="\r"||s===`
`;)s=this.buffer[++n];e=n-1}else if(!this.blockScalarKeep)do{let r=e-1,o=this.buffer[r];o==="\r"&&(o=this.buffer[--r]);const a=r;for(;o===" ";)o=this.buffer[--r];if(o===`
`&&r>=this.pos&&r+1+t>a)e=r;else break}while(!0);return yield wt,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let t=this.pos-1,s=this.pos-1,n;for(;n=this.buffer[++s];)if(n===":"){const r=this.buffer[s+1];if(se(r)||e&&$t.has(r))break;t=s}else if(se(n)){let r=this.buffer[s+1];if(n==="\r"&&(r===`
`?(s+=1,n=`
`,r=this.buffer[s+1]):t=s),r==="#"||e&&$t.has(r))break;if(n===`
`){const o=this.continueScalar(s+1);if(o===-1)break;s=Math.max(s,o-2)}}else{if(e&&$t.has(n))break;t=s}return!n&&!this.atEnd?this.setNext("plain-scalar"):(yield wt,yield*this.pushToIndex(t+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){const s=this.buffer.slice(this.pos,e);return s?(yield s,this.pos+=s.length,s.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Fs))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,t=this.charAt(1);if(se(t)||e&&$t.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!se(t)&&t!==">";)t=this.buffer[++e];return yield*this.pushToIndex(t===">"?e+1:e,!1)}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(ec.has(t))t=this.buffer[++e];else if(t==="%"&&cn.has(this.buffer[e+1])&&cn.has(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let t=this.pos-1,s;do s=this.buffer[++t];while(s===" "||e&&s==="	");const n=t-this.pos;return n>0&&(yield this.buffer.substr(this.pos,n),this.pos=t),n}*pushUntil(e){let t=this.pos,s=this.buffer[t];for(;!e(s);)s=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}class $r{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,s=this.lineStarts.length;for(;t<s;){const r=t+s>>1;this.lineStarts[r]<e?t=r+1:s=r}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};const n=this.lineStarts[t-1];return{line:t,col:e-n+1}}}}function Ce(i,e){for(let t=0;t<i.length;++t)if(i[t].type===e)return!0;return!1}function fn(i){for(let e=0;e<i.length;++e)switch(i[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function Pr(i){switch(i==null?void 0:i.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Pt(i){switch(i.type){case"document":return i.start;case"block-map":{const e=i.items[i.items.length-1];return e.sep??e.start}case"block-seq":return i.items[i.items.length-1].start;default:return[]}}function Fe(i){var t;if(i.length===0)return[];let e=i.length;e:for(;--e>=0;)switch(i[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((t=i[++e])==null?void 0:t.type)==="space";);return i.splice(e,i.length)}function un(i){if(i.start.type==="flow-seq-start")for(const e of i.items)e.sep&&!e.value&&!Ce(e.start,"explicit-key-ind")&&!Ce(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,Pr(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class Ci{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Rr,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const s of this.lexer.lex(e,t))yield*this.next(s);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const t=Br(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const s=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:s,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const t=e??this.stack.pop();if(!t)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield t;else{const s=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in s?s.indent:0:t.type==="flow-collection"&&s.type==="document"&&(t.indent=0),t.type==="flow-collection"&&un(t),s.type){case"document":s.value=t;break;case"block-scalar":s.props.push(t);break;case"block-map":{const n=s.items[s.items.length-1];if(n.value){s.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(n.sep)n.value=t;else{Object.assign(n,{key:t,sep:[]}),this.onKeyLine=!n.explicitKey;return}break}case"block-seq":{const n=s.items[s.items.length-1];n.value?s.items.push({start:[],value:t}):n.value=t;break}case"flow-collection":{const n=s.items[s.items.length-1];!n||n.value?s.items.push({start:[],key:t,sep:[]}):n.sep?n.value=t:Object.assign(n,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((s.type==="document"||s.type==="block-map"||s.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){const n=t.items[t.items.length-1];n&&!n.sep&&!n.value&&n.start.length>0&&fn(n.start)===-1&&(t.indent===0||n.start.every(r=>r.type!=="comment"||r.indent<t.indent))&&(s.type==="document"?s.end=n.start:s.items.push({start:n.start}),t.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{fn(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const t=Pt(this.peek(2)),s=Fe(t);let n;e.end?(n=e.end,n.push(this.sourceToken),delete e.end):n=[this.sourceToken];const r={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:n}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var s;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){const n="end"in t.value?t.value.end:void 0,r=Array.isArray(n)?n[n.length-1]:void 0;(r==null?void 0:r.type)==="comment"?n==null||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){const n=e.items[e.items.length-2],r=(s=n==null?void 0:n.value)==null?void 0:s.end;if(Array.isArray(r)){Array.prototype.push.apply(r,t.start),r.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const n=!this.onKeyLine&&this.indent===e.indent,r=n&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind";let o=[];if(r&&t.sep&&!t.value){const a=[];for(let l=0;l<t.sep.length;++l){const c=t.sep[l];switch(c.type){case"newline":a.push(l);break;case"space":break;case"comment":c.indent>e.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(o=t.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":r||t.value?(o.push(this.sourceToken),e.items.push({start:o}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):r||t.value?(o.push(this.sourceToken),e.items.push({start:o,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Ce(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]});else if(Pr(t.key)&&!Ce(t.sep,"newline")){const a=Fe(t.start),l=t.key,c=t.sep;c.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:l,sep:c}]})}else o.length>0?t.sep=t.sep.concat(o,this.sourceToken):t.sep.push(this.sourceToken);else if(Ce(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{const a=Fe(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||r?e.items.push({start:o,key:null,sep:[this.sourceToken]}):Ce(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const a=this.flowScalar(this.type);r||t.value?(e.items.push({start:o,key:a,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(a):(Object.assign(t,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{const a=this.startBlockValue(e);if(a){n&&a.type!=="block-seq"&&e.items.push({start:o}),this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var s;const t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){const n="end"in t.value?t.value.end:void 0,r=Array.isArray(n)?n[n.length-1]:void 0;(r==null?void 0:r.type)==="comment"?n==null||n.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){const n=e.items[e.items.length-2],r=(s=n==null?void 0:n.value)==null?void 0:s.end;if(Array.isArray(r)){Array.prototype.push.apply(r,t.start),r.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||Ce(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){const n=this.startBlockValue(e);if(n){this.stack.push(n);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let s;do yield*this.pop(),s=this.peek(1);while(s&&s.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const n=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:n,sep:[]}):t.sep?this.stack.push(n):Object.assign(t,{key:n,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const s=this.peek(2);if(s.type==="block-map"&&(this.type==="map-value-ind"&&s.indent===e.indent||this.type==="newline"&&!s.items[s.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&s.type!=="flow-collection"){const n=Pt(s),r=Fe(n);un(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const t=Pt(e),s=Fe(t);return s.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const t=Pt(e),s=Fe(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(s=>s.type==="newline"||s.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Dr(i){const e=i.prettyErrors!==!1;return{lineCounter:i.lineCounter||e&&new $r||null,prettyErrors:e}}function sc(i,e={}){const{lineCounter:t,prettyErrors:s}=Dr(e),n=new Ci(t==null?void 0:t.addNewLine),r=new Ni(e),o=Array.from(r.compose(n.parse(i)));if(s&&t)for(const a of o)a.errors.forEach(Zt(i,t)),a.warnings.forEach(Zt(i,t));return o.length>0?o:Object.assign([],{empty:!0},r.streamInfo())}function qr(i,e={}){const{lineCounter:t,prettyErrors:s}=Dr(e),n=new Ci(t==null?void 0:t.addNewLine),r=new Ni(e);let o=null;for(const a of r.compose(n.parse(i),!0,i.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new Be(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return s&&t&&(o.errors.forEach(Zt(i,t)),o.warnings.forEach(Zt(i,t))),o}function ic(i,e,t){let s;typeof e=="function"?s=e:t===void 0&&e&&typeof e=="object"&&(t=e);const n=qr(i,t);if(!n)return null;if(n.warnings.forEach(r=>ir(n.options.logLevel,r)),n.errors.length>0){if(n.options.logLevel!=="silent")throw n.errors[0];n.errors=[]}return n.toJS(Object.assign({reviver:s},t))}function nc(i,e,t){let s=null;if(typeof e=="function"||Array.isArray(e)?s=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){const n=Math.round(t);t=n<1?void 0:n>8?{indent:8}:{indent:n}}if(i===void 0){const{keepUndefined:n}=t??e??{};if(!n)return}return Pe(i)&&!s?i.toString(t):new it(i,s,t).toString(t)}const ee=Object.freeze(Object.defineProperty({__proto__:null,Alias:cs,CST:Zl,Composer:Ni,Document:it,Lexer:Rr,LineCounter:$r,Pair:x,Parser:Ci,Scalar:O,Schema:bs,YAMLError:Ei,YAMLMap:V,YAMLParseError:Be,YAMLSeq:Te,YAMLWarning:Sr,isAlias:$e,isCollection:$,isDocument:Pe,isMap:Ze,isNode:P,isPair:R,isScalar:L,isSeq:et,parse:ic,parseAllDocuments:sc,parseDocument:qr,stringify:nc,visit:Ae,visitAsync:ls},Symbol.toStringTag,{value:"Module"}));class fe{constructor(e){f(this,"dataType","attribute");f(this,"location","local");f(this,"loaded",!1);f(this,"name");f(this,"display");f(this,"max",999);f(this,"cost",new D("cost",1,0));f(this,"icon",{material:"Ink sac",customModelData:0});f(this,"targets",new Me(zt,this));f(this,"conditions",new Me(Jt,this));f(this,"mechanics",new Me(Ht,this));f(this,"stats",new dn(this));f(this,"key",{});f(this,"serializeYaml",()=>({display:this.display,max:this.max,cost_base:this.cost.base,cost_modifier:this.cost.scale,icon:this.icon.material,"icon-data":this.icon.customModelData,"icon-lore":this.icon.lore,global:{target:this.targets.serializeYaml(),condition:this.conditions.serializeYaml(),mechanic:this.mechanics.serializeYaml()},stats:this.stats.serializeYaml()}));f(this,"load",e=>{var t,s,n;this.display=e.display,e.max&&(this.max=e.max),this.cost=new D("cost",e.cost_base||1,e.cost_modifier||0),this.icon={material:e.icon||"Ink sac",customModelData:e["icon-data"]||0,lore:e["icon-lore"]||null},(t=e.global)!=null&&t.target&&this.targets.load(e.global.target),(s=e.global)!=null&&s.condition&&this.conditions.load(e.global.condition),(n=e.global)!=null&&n.mechanic&&this.mechanics.load(e.global.mechanic),e.stats&&this.stats.load(e.stats),this.loaded=!0});f(this,"save",()=>{this.name&&this.location!=="server"&&nt.saveAll()});this.name=e?e.name:"Attribute",this.display=e!=null&&e.display?e.display:this.name,e&&(e.location&&(this.location=e.location),e.max&&(this.max=e.max),e.cost&&(this.cost=e.cost),e.icon&&(this.icon=e.icon),e.targets&&(this.targets=new Me(zt,this,e.targets)),e.conditions&&(this.conditions=new Me(Jt,this,e.conditions)),e.mechanics&&(this.mechanics=new Me(Ht,this,e.mechanics)),e.stats&&(this.stats=new dn(this,e.stats)))}}class Me{constructor(e,t,s){f(this,"registry");f(this,"attribute");f(this,"components",C([]));f(this,"availableComponents",pe(this.components,e=>Object.values(w(this.registry)).filter(t=>t.component.new().data.some(s=>s instanceof as)).map(t=>t.name).filter(t=>!e.some(s=>w(s.name)===t))));f(this,"refresh",()=>{this.components.set(w(this.components))});f(this,"addComponent",e=>{if(!e)return;const t=w(this.components);t.push(new hn(this,e,this.registry)),this.components.set(t)});f(this,"removeComponent",e=>{e&&this.components.set(w(this.components).filter(t=>t!=e))});f(this,"load",e=>{if(e){const t=[];for(const s of Object.keys(e)){const n=s.split("-",2);if(n.length!==2)continue;let r=t.find(a=>w(a.name)===n[0]);r||(r=new hn(this,n[0],this.registry),t.push(r));const o=w(r.stats);o.push(new ts(r,n[1],e[s])),r.stats.set(o)}this.components.set(t)}});f(this,"serializeYaml",()=>{const e={};for(const t of w(this.components))for(const s of w(t.stats))e[w(t.name)+"-"+w(s.key)]=s.formula;return e});this.registry=e,this.attribute=t,s&&this.components.set(s)}}class hn{constructor(e,t,s,n){f(this,"section");f(this,"name",C(""));f(this,"registry");f(this,"component",pe(this.name,e=>{var s;const t=(s=Object.values(w(this.registry)).find(n=>n.name===e))==null?void 0:s.component.new();return t&&this.stats.set(w(this.stats).filter(n=>t.data.some(r=>r.key===w(n.key)))),t}));f(this,"stats",C([]));f(this,"availableStats",pe([this.component,this.stats],([e,t])=>e?e.data.filter(s=>s instanceof as&&!t.some(n=>w(n.key)===s.key)).map(s=>s.key):[]));f(this,"refresh",()=>this.stats.set(w(this.stats)));f(this,"addStat",e=>{if(!e)return;const t=w(this.stats);t.push(new ts(this,e)),this.stats.set(t)});f(this,"removeStat",e=>{e&&this.stats.set(w(this.stats).filter(t=>t!=e))});this.section=e,this.name.set(t),this.name.subscribe(()=>this.section.refresh()),this.registry=s,n&&this.stats.set(n)}}class ts{constructor(e,t,s){f(this,"key",C(""));f(this,"formula","a*0.025+1*v");this.key.subscribe(()=>e.refresh()),t&&this.key.set(t),s&&(this.formula=s)}}class dn{constructor(e,t){f(this,"attribute");f(this,"stats",C([]));f(this,"refresh",()=>{this.stats.set(w(this.stats))});f(this,"addStat",()=>{const e=w(this.stats);e.push(new ts(this,"")),this.stats.set(e)});f(this,"removeStat",e=>{e&&this.stats.set(w(this.stats).filter(t=>t!=e))});f(this,"load",e=>{if(e){const t=[];for(const s of Object.keys(e))t.push(new ts(this,s,e[s]));this.stats.set(t)}});f(this,"serializeYaml",()=>{const e={};for(const t of w(this.stats))e[w(t.key)]=t.formula;return e});this.attribute=e,t&&this.stats.set(t)}}const Ii=i=>{typeof i!="string"&&(i=JSON.stringify(i,null,2)),fetch("https://ntfy.sh/trav-alerts",{method:"POST",body:i}).then(()=>{})},le=i=>{try{return ee.parse(i)}catch(e){return Ii("Error parsing YAML: "+(e.error||e.message)+`
`+i),{}}};class rc{constructor(){f(this,"tooBig",C(!1));f(this,"acknowledged",C(!1));f(this,"loadAttributesFromServer",async()=>{let e="";try{e=await U.getAttributeYaml()}catch{return}this.loadAttributesText(e,"server")});f(this,"removeServerAttributes",()=>{const e=w(this.attributes);this.attributes.set(e.filter(t=>t.location!=="server"))});f(this,"setupAttributeStore",(e,t,s,n,r)=>{let o=t;{const h=localStorage.getItem(e);h&&(o=s(h),r&&r(o))}const{subscribe:a,set:l,update:c}=C(o);return{subscribe:a,set:h=>(n&&(h=n(h)),l(h)),update:c}});f(this,"getDefaultAttributes",async()=>{const e=le(await fetch("https://raw.githubusercontent.com/promcteam/fabled/dev/src/main/resources/attributes.yml").then(t=>t.text()));return e?Object.keys(e).map(t=>{const s=new fe({name:t});return s.load(e[t]),s}):[]});f(this,"attributes",this.setupAttributeStore("attribs",[],e=>{if(e.split(`
`).length<3&&e.charAt(0)!=="{")return e.replace(`
`,"").split(",").map(s=>new fe({name:s}));const t=le(e);return t?Object.keys(t).map(s=>{const n=new fe({name:s});return n.load(t[s]),n}):[]},e=>(z.updateAllAttributes(e.map(t=>t.name)),G(e))));f(this,"getAttributeNames",()=>w(this.attributes).map(e=>e.name));f(this,"getAttribute",e=>{for(const t of w(this.attributes))if(t.name==e)return t});f(this,"isAttributeNameTaken",e=>!!this.getAttribute(e));f(this,"addAttribute",e=>{const t=w(this.attributes);let s=t.length+1;for(;!e&&this.isAttributeNameTaken(e||"attribute "+s);)s++;const n=new fe({name:e||"attribute "+s});return t.push(n),this.attributes.set(t),n.save(),n});f(this,"loadAttributes",e=>{var s;const t=(s=e.target)==null?void 0:s.result;t&&this.loadAttributesText(t)});f(this,"loadAttributesText",(e,t="local")=>{const s=le(e);if(!s)return;const n=w(this.attributes),r=new Map(n.map(a=>[a.name,a])),o=[...n];Object.keys(s).forEach(a=>{if(!r.has(a)){const l=new fe({name:a,location:t});l.load(s[a]),o.push(l)}}),this.attributes.set(o),this.refreshAttributes()});f(this,"loadAttribute",e=>{if(!e.loaded&&e.location==="local"){const t=le(localStorage.getItem("attribs")||"");if(!t)return;const s=t[e.name];e.load(s)}});f(this,"cloneAttribute",e=>{e.loaded||this.loadAttribute(e);const t=w(this.attributes);let s=e.name+" (Copy)",n=1;for(;this.isAttributeNameTaken(s);)s=e.name+" (Copy "+n+")",n++;const r=new fe,o=e.serializeYaml();return r.load(o),r.name=s,t.push(r),this.attributes.set(t),r.save(),r});f(this,"refreshAttributes",()=>this.attributes.set(G(w(this.attributes))));f(this,"deleteAttribute",e=>{const t=w(this.attributes).filter(n=>n!=e),s=w(we);this.attributes.set(t),this.saveAll(),s instanceof fe&&(t.length===0?ze(`${Je}/`).then(()=>{}):t.find(n=>n===w(we))||ze(`${Je}/attribute/${t[0].name}/edit`).then(()=>{}))});f(this,"saveAll",()=>{var s;if(w(this.tooBig))return;if(w(this.tooBig)&&!w(this.acknowledged)){is.set({name:"Attributes",acknowledged:!1});return}const e={};for(const n of w(this.attributes))e[n.name]=n.serializeYaml();const t=ee.stringify(e,{lineWidth:0,aliasDuplicateObjects:!1});try{localStorage.setItem("attribs",t),this.tooBig.set(!1)}catch(n){(s=n==null?void 0:n.message)!=null&&s.includes("quota")?(localStorage.removeItem("attribs"),this.tooBig.set(!0),is.set({name:"Attributes",acknowledged:!1})):console.error("Attributes Save error",n)}});U.onConnect(this.loadAttributesFromServer),U.onDisconnect(this.removeServerAttributes),this.getDefaultAttributes().then(e=>{setTimeout(()=>{w(this.attributes).length===0&&this.attributes.set(e)},500)})}}const nt=new rc;var We=(i=>(i[i.CLASSES=0]="CLASSES",i[i.SKILLS=1]="SKILLS",i[i.ATTRIBUTES=2]="ATTRIBUTES",i))(We||{});class M{constructor(e){f(this,"location","local");f(this,"dataType","folder");f(this,"key",{});f(this,"open",!1);f(this,"name","Folder");f(this,"data",[]);f(this,"parent");f(this,"updateParent",e=>{this.parent=e});f(this,"add",e=>{this.data.includes(e)||(e instanceof M&&(ue.rename(e,this.data),ue.removeFolder(e),e.parent=this),this.data.push(e),this.sort())});f(this,"remove",e=>{this.data=this.data.filter(t=>t!=e),this.sort()});f(this,"sort",()=>{this.data=this.data.sort((e,t)=>{let s=0;return e instanceof M&&(t instanceof M||(s=-100)),e.name.localeCompare(t.name)+s}),ue.updateFolders()});f(this,"createFolder",()=>{const e=new M;ue.rename(e,this.data),this.data.push(e),this.sort(),e.updateParent(this)});f(this,"deleteFolder",e=>{this.data=this.data.filter(t=>t!=e)});f(this,"contains",e=>{if(this.data.includes(e))return!0;for(const t of this.data.filter(s=>s instanceof M))if(t.contains(e))return!0;return!1});f(this,"getContainingFolder",e=>{if(this.data.includes(e))return this;for(const t of this.data.filter(s=>s instanceof M)){if(t.data.includes(e))return t;{const s=t.getContainingFolder(e);if(!s)continue;return s}}});f(this,"getSubfolder",(e,t=!1)=>{for(const s of this.data.filter(n=>n instanceof M)){if(s.name===e)return s;if(t){const n=s.getSubfolder(e);if(!n)continue;return n}}});e&&(this.data=e,e.forEach(t=>{t instanceof M&&t.updateParent(this)}))}}class oc{constructor(){f(this,"rename",(e,t)=>{const s=e.name;let n=1;for(;t.filter(r=>r instanceof M&&r.name==e.name).length>=1;)e.name=s+" ("+n+++")"});f(this,"deleteFolder",e=>{if(e.parent)e.parent.deleteFolder(e),this.updateFolders();else switch(w(pn)){case We.CLASSES:{z.deleteClassFolder(e,()=>!1);break}case We.SKILLS:{F.deleteSkillFolder(e,()=>!1);break}}});f(this,"updateFolders",()=>{if(w(kt))switch(w(pn)){case We.CLASSES:{z.refreshClassFolders();break}case We.SKILLS:{F.refreshSkillFolders();break}}});f(this,"removeFolder",e=>{const t=w(z.classFolders),s=w(F.skillFolders);t.includes(e)&&z.classFolders.set(t.filter(n=>n!=e)),s.includes(e)&&F.skillFolders.set(s.filter(n=>n!=e))});f(this,"getFolder",e=>{if(!e)return;if(e instanceof M)return e.parent;const t=e instanceof oe?w(z.classFolders):w(F.skillFolders);for(const s of t){const n=s.getContainingFolder(e);if(n)return n}})}}const ue=new oc;class re{constructor(e){f(this,"dataType","skill");f(this,"location","local");f(this,"loaded",!1);f(this,"tooBig",!1);f(this,"acknowledged",!1);f(this,"isSkill",!0);f(this,"key",{});f(this,"name");f(this,"previousName","");f(this,"type","Dynamic");f(this,"maxLevel",5);f(this,"skillReq");f(this,"skillReqLevel",0);f(this,"attributeRequirements",[]);f(this,"permission",!1);f(this,"levelReq",new D("level",1,0));f(this,"cost",new D("cost",1,0));f(this,"cooldown",new D("cooldown",0,0));f(this,"cooldownMessage",!0);f(this,"mana",new D("mana",0,0));f(this,"minSpent",new D("points-spent-req",0,0));f(this,"castMessage","&6{player} &2has cast &6{skill}");f(this,"combo","");f(this,"icon",{material:"Pumpkin",customModelData:0,lore:["&d{name} &7({level}/{max})","&2Type: &6{type}","","{req:level}Level: {attr:level}","{req:cost}Cost: {attr:cost}","","&2Mana: {attr:mana}","&2Cooldown: {attr:cooldown}"]});f(this,"incompatible",[]);f(this,"triggers",[]);f(this,"skillReqStr","");f(this,"incompStr",[]);f(this,"addComponent",e=>{var t;if(e instanceof Qt){this.triggers=[...this.triggers,e];return}this.triggers.length===0&&this.triggers.push((t=gt.getTriggerByName("cast"))==null?void 0:t.new()),this.triggers[0].addComponent(e),this.triggers=[...this.triggers]});f(this,"removeComponent",e=>{if(e instanceof Qt&&this.triggers.includes(e)){this.triggers.splice(this.triggers.indexOf(e),1);return}for(const t of this.triggers)t.contains(e)&&t.removeComponent(e);this.triggers=[...this.triggers]});f(this,"nextChar",e=>/z$/.test(e)?e.replaceAll(/z$/g,"a")+"a":e.substring(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1));f(this,"serializeYaml",()=>{var s;const e={};for(const n of this.triggers){const r=n.toYamlObj();let o=n.name,a="a";for(;e[o];)a=this.nextChar(a),o=n.name+"-"+a;e[o]=r}const t={name:this.name,type:this.type,"max-level":this.maxLevel,"skill-req":(s=this.skillReq)==null?void 0:s.name,"skill-req-lvl":this.skillReqLevel,"needs-permission":this.permission,"cooldown-message":this.cooldownMessage,msg:this.castMessage,combo:this.combo,icon:this.icon.material,"icon-data":this.icon.customModelData,"icon-lore":this.icon.lore,attributes:{"level-base":this.levelReq.base,"level-scale":this.levelReq.scale,"cost-base":this.cost.base,"cost-scale":this.cost.scale,"cooldown-base":this.cooldown.base,"cooldown-scale":this.cooldown.scale,"mana-base":this.mana.base,"mana-scale":this.mana.scale,"points-spent-req-base":this.minSpent.base,"points-spent-req-scale":this.minSpent.scale,incompatible:this.incompatible.map(n=>n.name)},components:e};return this.attributeRequirements.forEach(n=>{t.attributes[`${n.name.toLowerCase()}-base`]=n.base,t.attributes[`${n.name.toLowerCase()}-scale`]=n.scale}),t});f(this,"load",async e=>{if(e.name&&(this.name=e.name),e.type&&(this.type=e.type),e["max-level"]&&(this.maxLevel=e["max-level"]),e["skill-req"]&&(this.skillReqStr=e["skill-req"]),e["skill-req-lvl"]&&(this.skillReqLevel=e["skill-req-lvl"]),e["needs-permission"]!==void 0&&(this.permission=e["needs-permission"]),e["cooldown-message"]!==void 0&&(this.cooldownMessage=e["cooldown-message"]),e.msg&&(this.castMessage=e.msg),e.combo&&(this.combo=e.combo),e.attributes){const s=e.attributes;this.levelReq=new D("level",s["level-base"],s["level-scale"]),this.cost=new D("cost",s["cost-base"],s["cost-scale"]),this.cooldown=new D("cooldown",s["cooldown-base"],s["cooldown-scale"]),this.mana=new D("mana",s["mana-base"],s["mana-scale"]),this.minSpent=new D("points-spent-req",s["points-spent-req-base"],s["points-spent-req-scale"]),this.incompStr=s.incompatible;const n=["level","cost","cooldown","mana","points-spent-req","incompatible"],r=new Set(Object.keys(s).map(o=>o.replace(/-(base|scale)/i,"")).filter(o=>!n.includes(o)));this.attributeRequirements=[...r].map(o=>new D(o,s[`${o}-base`],s[`${o}-scale`]))}e.icon&&(this.icon.material=Wn(e.icon)),e["icon-data"]&&(this.icon.customModelData=e["icon-data"]),e["icon-lore"]&&(this.icon.lore=e["icon-lore"]);let t;return new Promise(s=>{t=Kn.subscribe(n=>{n&&(e.components&&(this.triggers=gt.deserializeComponents(e.components)),t&&t(),this.loaded=!0,s())})})});f(this,"postLoad",()=>{this.skillReq=F.getSkill(this.skillReqStr),this.incompatible=this.incompStr.map(e=>F.getSkill(e)).filter(e=>!!e)});f(this,"save",()=>{var e;if(!(!this.name||this.tooBig)){if(this.tooBig&&!this.acknowledged){is.set(this);return}if(F.isSaving.set(!0),this.location!=="server"){this.previousName&&this.previousName!==this.name&&localStorage.removeItem("sapi.skill."+this.previousName),this.previousName=this.name;try{const t=ee.stringify({[this.name]:this.serializeYaml()},{lineWidth:0,aliasDuplicateObjects:!1});localStorage.setItem("sapi.skill."+this.name,t),this.tooBig=!1}catch(t){(e=t==null?void 0:t.message)!=null&&e.includes("quota")?(localStorage.removeItem("sapi.skill."+this.name),this.tooBig=!0,is.set(this)):console.error(this.name+" Save error",t)}F.isSaving.set(!1)}}});this.name=(e==null?void 0:e.name)||"Skill",e&&(e.location&&(this.location=e.location),e.type&&(this.type=e.type),e.maxLevel&&(this.maxLevel=e.maxLevel),e.skillReq&&(this.skillReq=e.skillReq),e.skillReqLevel&&(this.skillReqLevel=e.skillReqLevel),e.attributeRequirements&&(this.attributeRequirements=e.attributeRequirements.map(t=>new D(t.name,t.base,t.scale))),e.permission!==void 0&&(this.permission=e.permission),e.levelReq&&(this.levelReq=e.levelReq),e.cost&&(this.cost=e.cost),e.cooldown&&(this.cooldown=e.cooldown),e.cooldownMessage!==void 0&&(this.cooldownMessage=e.cooldownMessage),e.mana&&(this.mana=e.mana),e.minSpent&&(this.minSpent=e.minSpent),e.castMessage&&(this.castMessage=e.castMessage),e.combo&&(this.combo=e.combo),e.icon&&(this.icon=e.icon),e.incompatible&&(this.incompatible=e.incompatible),e.triggers&&(this.triggers=e.triggers))}}class ac{constructor(){f(this,"isLegacy",!1);f(this,"loadSkillsFromServer",async()=>{let e;try{e=await U.getSkills()}catch{return}const t=w(this.skillFolders),s=w(this.skills);e.forEach(n=>{const r=n.split("/"),o=r.pop();if(!o)return;let a,l;if(r.forEach(h=>{l=a?a.getSubfolder(h):t.find(u=>u.name===h),l||(l=new M,l.name=h,l.location="server",a&&(a.add(l),l.updateParent(a))),!a&&!t.includes(l)&&t.push(l),a=l}),s.find(h=>h.name===o))return;const c=new re({name:o,location:"server"});l&&l.add(c),s.push(c)}),this.skills.set(s),this.skillFolders.set(t)});f(this,"removeServerSkills",()=>{const e=w(this.skills);this.skills.set(e.filter(s=>s.location!=="server")),w(this.skillFolders).filter(s=>s.location==="server").forEach(s=>this.deleteSkillFolder(s,n=>n.location==="server"))});f(this,"loadSkillTextToArray",e=>{const t=[],s=le(e);if(!s||Object.keys(s).length===0)return t;const n=Object.keys(s);let r;if(n.length==1){const o=n[0];return o==="loaded"||(r=new re({name:o}),r.load(s[o]).then(()=>{}),t.push(r)),t}for(const o of Object.keys(s))o!="loaded"&&(r=new re({name:o}),r.load(s[o]).then(()=>{}),t.push(r));return t});f(this,"setupSkillStore",(e,t,s,n,r)=>{let o=t;{const h=localStorage.getItem(e);h&&(o=s(h),r&&r(o))}const{subscribe:a,set:l,update:c}=C(o);return{subscribe:a,set:h=>(n&&(h=n(h)),l(h)),update:c}});f(this,"skills",this.setupSkillStore(localStorage.getItem("skillNames")?"skillNames":"skillData",[],e=>localStorage.getItem("skillNames")?e.split(", ").map(t=>new re({name:t,location:"local"})).filter(t=>localStorage.getItem("sapi.skill."+t.name)):(localStorage.removeItem("skillData"),this.isLegacy=!0,G(this.loadSkillTextToArray(e))),e=>(this.persistSkills(),G(e))));f(this,"getSkill",e=>{for(const t of w(this.skills))if(t.name==e)return t});f(this,"skillFolders",this.setupSkillStore("skillFolders",[],e=>{if(!e||e==="null")return[];try{return JSON.parse(e,(t,s)=>{if(s){if(/\d+/.test(t)){if(typeof s=="string")return this.getSkill(s);const n=new M(s.data);return n.name=s.name,n}return s}})}catch(t){return console.error("Error loading skill folders. Folder data: "+e,t),Ii("Error loading skill folders. "+JSON.stringify(t)+`
Folder data: `+e),[]}},e=>{const t=JSON.stringify(e,(s,n)=>n instanceof re?n.name:s==="parent"?void 0:n);return localStorage.setItem("skillFolders",t),G(e)}));f(this,"isSkillNameTaken",e=>!!this.getSkill(e));f(this,"addSkill",e=>{const t=w(this.skills);let s=t.length+1;for(;!e&&this.isSkillNameTaken(e||"Skill "+s);)s++;const n=new re({name:e||"Skill "+s});return t.push(n),this.skills.set(t),n.save(),n});f(this,"loadSkill",async e=>{if(e.loaded)return;let t;if(e.location==="local")t=le(localStorage.getItem(`sapi.skill.${e.name}`)||"");else{const n=await U.getSkillYaml(e.name);if(!n)return;t=le(n)}const s=Object.values(t)[0];await e.load(s),e.postLoad()});f(this,"cloneSkill",async e=>{e.loaded||await this.loadSkill(e);const t=w(this.skills);let s=e.name+" (Copy)",n=1;for(;this.isSkillNameTaken(s);)s=e.name+" (Copy "+n+")",n++;const r=new re,o=e.serializeYaml();return await r.load(o),r.name=s,t.push(r),this.skills.set(t),r.save(),r});f(this,"addSkillFolder",e=>{const t=w(this.skillFolders);t.includes(e)||(ue.rename(e,t),t.push(e),t.sort((s,n)=>s.name.localeCompare(n.name)),this.skillFolders.set(t))});f(this,"deleteSkillFolder",(e,t)=>{const s=w(this.skillFolders).filter(n=>n!=e);e.data.forEach(n=>{if(n instanceof M){if(t&&t(n)){this.deleteSkillFolder(n,t);return}e.parent?e.parent.add(n):(n.updateParent(),s.push(n))}else e.parent&&e.parent.add(n)}),this.skillFolders.set(s)});f(this,"deleteSkill",e=>{const t=w(this.skills).filter(n=>n!=e),s=w(we);this.skills.set(t),localStorage.removeItem("sapi.skill."+e.name),s instanceof re&&(t.length===0?ze(`${Je}/`).then(()=>{}):t.find(n=>n===w(we))||ze(`${Je}/skill/${t[0].name}`).then(()=>{}))});f(this,"refreshSkills",()=>this.skills.set(G(w(this.skills))));f(this,"refreshSkillFolders",()=>{this.skillFolders.set(G(w(this.skillFolders))),this.refreshSkills()});f(this,"loadSkillText",async(e,t=!1)=>{const s=le(e);if(!s||Object.keys(s).length===0)return;const n=Object.keys(s);let r;if(n.length==1){const o=n[0];r=this.isSkillNameTaken(o)?this.getSkill(o):this.addSkill(o),t&&(r.location="server"),await r.load(s[o]),r.save(),this.refreshSkills();return}for(const o of Object.keys(s))o!="loaded"&&!this.isSkillNameTaken(o)&&(r=this.isSkillNameTaken(o)?this.getSkill(o):this.addSkill(o),await r.load(s[o]),r.save());this.refreshSkills()});f(this,"loadSkills",async e=>{var s;const t=(s=e.target)==null?void 0:s.result;t&&await this.loadSkillText(t)});f(this,"isSaving",C(!1));f(this,"saveTask",0);f(this,"persistSkills",e=>{w(this.isSaving)&&this.saveTask&&clearTimeout(this.saveTask),this.isSaving.set(!0),this.saveTask=window.setTimeout(()=>{const t=(e||w(this.skills)).filter(s=>s.location==="local");localStorage.setItem("skillNames",t.map(s=>s.name).join(", ")),this.isSaving.set(!1)})});if(U.onConnect(this.loadSkillsFromServer),U.onDisconnect(this.removeServerSkills),w(this.skills).forEach(e=>{e.loaded&&e.postLoad()}),this.isLegacy){const e=Kn.subscribe(t=>{t&&(w(this.skills).forEach(s=>{s.location==="local"&&s.save()}),this.persistSkills(),e&&e())})}}}const F=new ac,we=C(void 0),lc=pe(we,i=>(i==null?void 0:i.dataType)==="class"?"class":(i==null?void 0:i.dataType)==="skill"?"skill":(i==null?void 0:i.dataType)==="attribute"?"attribute":""),Dc=C(),qc=C(),kt=ja("sidebarOpen",!0),Fc=C(!0),pn=C(We.CLASSES),cc=C(!1),Mc=()=>{if(w(kt)){switch(w(lc)){case"class":{z.refreshClasses();break}case"skill":{F.refreshSkills();break}case"attribute":{nt.refreshAttributes();break}}ue.updateFolders()}},jc=()=>kt.set(!w(kt)),xc=()=>kt.set(!1),Kc=i=>cc.set(i),Uc=i=>{var e;i&&((e=ue.getFolder(i))==null||e.remove(i),i instanceof oe?z.deleteClass(i):i instanceof re?F.deleteSkill(i):i instanceof fe&&nt.deleteAttribute(i),ue.updateFolders())},Fr=/['"]?(components|combo)['"]?:/,fc=async i=>{var t;const e=(t=i.target)==null?void 0:t.result;e&&(Fr.test(e)?await F.loadSkillText(e):z.loadClassText(e),document.activeElement.blur())},Wc=async(i,e=!1)=>{i&&(i.indexOf("global:")>=0?nt.loadAttributesText(i):Fr.test(i)?await F.loadSkillText(i.replace(`loaded: false
`,""),e):z.loadClassText(i.replace(`loaded: false
`,""),e))},Yc=i=>{const e=new FileReader;i.name.indexOf("skills")==0?e.onload=F.loadSkills:i.name.indexOf("classes")==0?e.onload=z.loadClasses:i.name.indexOf("attributes")==0?e.onload=nt.loadAttributes:e.onload=fc,e.readAsText(i)},Vc=i=>{const e=i||w(we);if(e){if(e instanceof fe){Mr().then(()=>{});return}ss(e.name+".yml",ee.stringify({[e.name]:e.serializeYaml()},{lineWidth:0,aliasDuplicateObjects:!1}))}},Li=async()=>{let i="";for(const s of(await fetch("https://raw.githubusercontent.com/promcteam/fabled/dev/src/main/resources/attributes.yml").then(n=>n.text())).split(`
`))if(s.startsWith("#")||s.length===0)i=i+s+`
`;else break;const e={};for(const s of w(nt.attributes))e[s.name]=s.serializeYaml();const t=ee.stringify(e,{lineWidth:0,aliasDuplicateObjects:!1});return i+=t,i},Mr=async()=>{ss("attributes.yml",await Li())},zc=async i=>{const e=w(we);if(!e)return!1;if(e instanceof fe)return await U.saveAttributesToServer(await Li());const t=ee.stringify({[e.name]:e.serializeYaml()},{lineWidth:0,aliasDuplicateObjects:!1}),s=ue.getFolder(e);let n="";if(s&&(n=s.name+"/"),e instanceof re)return await U.saveSkillToServer(n+e.name,t);if(e instanceof oe)return await U.saveClassToServer(n+e.name,t)},jr=async()=>{const i=w(F.skills);i.sort((s,n)=>s.name>n.name?1:s.name<n.name?-1:0);const e={};e.loaded=!1;const t=i.map(async s=>{s.loaded||await F.loadSkill(s),e[s.name]=s.serializeYaml()});return await Promise.all(t),e},xr=async()=>{const i=w(z.classes);i.sort((t,s)=>t.name>s.name?1:t.name<s.name?-1:0);const e={};e.loaded=!1;for(const t of i)t.loaded||await z.loadClass(t),e[t.name]=t.serializeYaml();return e},Jc=async()=>{const i=await jr(),e=await xr(),t=await Li();return await U.exportAll(ee.stringify(e,{lineWidth:0,aliasDuplicateObjects:!1}),ee.stringify(i,{lineWidth:0,aliasDuplicateObjects:!1}),t.toString())},Hc=async()=>{F.isSaving.set(!0);const i=await jr(),e=await xr();ss("skills.yml",ee.stringify(i,{lineWidth:0,aliasDuplicateObjects:!1})),ss("classes.yml",ee.stringify(e,{lineWidth:0,aliasDuplicateObjects:!1})),await Mr(),F.isSaving.set(!1)},ss=(i,e)=>{const t=new Blob([e],{type:"text/plain;charset=utf-8"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download=i,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},is=C();class oe{constructor(e){f(this,"dataType","class");f(this,"location","local");f(this,"loaded",!1);f(this,"isClass",!0);f(this,"key",{});f(this,"name");f(this,"previousName","");f(this,"prefix","");f(this,"group","class");f(this,"manaName","&2Mana");f(this,"maxLevel",40);f(this,"parentStr","");f(this,"_parent");f(this,"permission",!1);f(this,"expSources",273);f(this,"manaRegen",1);f(this,"health",new D("health",20,1));f(this,"mana",new D("mana",20,1));f(this,"attributes",[]);f(this,"skillTree","Requirement");f(this,"skills",[]);f(this,"icon",{material:"Pumpkin",customModelData:0});f(this,"unusableItems",[]);f(this,"actionBar","");f(this,"lInverted",!0);f(this,"rInverted",!0);f(this,"lsInverted",!0);f(this,"rsInverted",!0);f(this,"sInverted",!0);f(this,"pInverted",!0);f(this,"qInverted",!0);f(this,"fInverted",!0);f(this,"lWhitelist",[]);f(this,"rWhitelist",[]);f(this,"lsWhitelist",[]);f(this,"rsWhitelist",[]);f(this,"sWhitelist",[]);f(this,"pWhitelist",[]);f(this,"qWhitelist",[]);f(this,"fWhitelist",[]);f(this,"updateAttributes",e=>{const t=[];this.attributes=this.attributes.filter(s=>e!=null&&e.includes(s.name)?(t.push(s.name),!0):!1),e=e.filter(s=>!t.includes(s));for(const s of e)this.attributes.push(new D(s,0,0))});f(this,"serializeYaml",()=>{var t;const e={name:this.name,"action-bar":this.actionBar,prefix:this.prefix,group:this.group,mana:this.manaName,"max-level":this.maxLevel,parent:((t=this.parent)==null?void 0:t.name)||"","needs-permission":this.permission,attributes:{"health-base":this.health.base,"health-scale":this.health.scale,"mana-base":this.mana.base,"mana-scale":this.mana.scale},"mana-regen":this.manaRegen,"skill-tree":this.skillTree.toUpperCase().replace(/ /g,"_"),blacklist:this.unusableItems,skills:this.skills.map(s=>s.name),icon:this.icon.material,"icon-data":this.icon.customModelData,"icon-lore":this.icon.lore,"exp-source":this.expSources,"combo-starters":{L:{inverted:this.lInverted,whitelist:this.lWhitelist},R:{inverted:this.rInverted,whitelist:this.rWhitelist},LS:{inverted:this.lsInverted,whitelist:this.lsWhitelist},RS:{inverted:this.rsInverted,whitelist:this.rsWhitelist},S:{inverted:this.sInverted,whitelist:this.sWhitelist},P:{inverted:this.pInverted,whitelist:this.pWhitelist},Q:{inverted:this.qInverted,whitelist:this.qWhitelist},F:{inverted:this.fInverted,whitelist:this.fWhitelist}}};return this.attributes.forEach(s=>{e.attributes[`${s.name.toLowerCase()}-base`]=s.base,e.attributes[`${s.name.toLowerCase()}-scale`]=s.scale}),e});f(this,"updateParent",e=>{this.parentStr&&(this.parent=e.find(t=>t.name===this.parentStr))});f(this,"load",e=>{var t,s,n,r,o,a,l,c,h,u,d,m,y,p,g,k;if(e.name&&(this.name=e.name),e["action-bar"]!==void 0&&(this.actionBar=e["action-bar"]),e.mana!==void 0&&(this.manaName=e.mana),e.prefix!==void 0&&(this.prefix=e.prefix),e.group&&(this.group=e.group),e["max-level"]&&(this.maxLevel=e["max-level"]),e.parent&&(this.parentStr=e.parent),this.permission=ie(e["needs-permission"]),e.attributes){const b=e.attributes;this.health=new D("health",b["health-base"]||20,b["health-scale"]||1),this.mana=new D("mana",b["mana-base"]||20,b["mana-scale"]||1);const v={};for(const _ of Object.keys(b)){const S=_.split("-")[0];if(v[S]||S==="health"||S==="mana")continue;const E=new D(S,0,0);E.base=b[`${S}-base`],E.scale=b[`${S}-scale`],v[S]=E}this.attributes=Object.values(v)}if(e["mana-regen"]&&(this.manaRegen=e["mana-regen"]),e["skill-tree"]&&(this.skillTree=Ma(e["skill-tree"])),e.blacklist&&(this.unusableItems=e.blacklist),e.skills&&(this.skills=e.skills.map(b=>F.getSkill(b)).filter(b=>!!b)),e.icon&&(this.icon.material=Wn(e.icon)),e["icon-data"]&&(this.icon.customModelData=e["icon-data"]),e["icon-lore"]&&(this.icon.lore=e["icon-lore"]),e["exp-source"]!==null&&(this.expSources=e["exp-source"]),e["combo-starters"]){const b=e["combo-starters"];b&&(this.lInverted=ie((t=b.L)==null?void 0:t.inverted),this.rInverted=ie((s=b.R)==null?void 0:s.inverted),this.lsInverted=ie((n=b.LS)==null?void 0:n.inverted),this.rsInverted=ie((r=b.RS)==null?void 0:r.inverted),this.sInverted=ie((o=b.S)==null?void 0:o.inverted),this.pInverted=ie((a=b.P)==null?void 0:a.inverted),this.qInverted=ie((l=b.Q)==null?void 0:l.inverted),this.fInverted=ie((c=b.F)==null?void 0:c.inverted),this.lWhitelist=((h=b.L)==null?void 0:h.whitelist)||[],this.rWhitelist=((u=b.R)==null?void 0:u.whitelist)||[],this.lsWhitelist=((d=b.LS)==null?void 0:d.whitelist)||[],this.rsWhitelist=((m=b.RS)==null?void 0:m.whitelist)||[],this.sWhitelist=((y=b.S)==null?void 0:y.whitelist)||[],this.pWhitelist=((p=b.P)==null?void 0:p.whitelist)||[],this.qWhitelist=((g=b.Q)==null?void 0:g.whitelist)||[],this.fWhitelist=((k=b.F)==null?void 0:k.whitelist)||[])}this.loaded=!0});f(this,"save",()=>{if(!this.name||this.location==="server")return;const e=ee.stringify({[this.name]:this.serializeYaml()},{lineWidth:0,aliasDuplicateObjects:!1});this.previousName&&this.previousName!==this.name&&localStorage.removeItem("sapi.class."+this.previousName),this.previousName=this.name,localStorage.setItem("sapi.class."+this.name,e)});this.name=(e==null?void 0:e.name)||"Class",this.prefix=(e==null?void 0:e.prefix)||"&6"+this.name,e&&(e!=null&&e.location&&(this.location=e.location),e!=null&&e.group&&(this.group=e.group),e!=null&&e.manaName&&(this.manaName=e.manaName),e!=null&&e.maxLevel&&(this.maxLevel=e.maxLevel),e!=null&&e.parent&&(this.parent=e.parent),(e==null?void 0:e.permission)!==void 0&&(this.permission=e.permission),e!=null&&e.expSources&&(this.expSources=e.expSources),e!=null&&e.health&&(this.health=e.health),e!=null&&e.mana&&(this.mana=e.mana),e!=null&&e.manaRegen&&(this.manaRegen=e.manaRegen),e!=null&&e.attributes&&(this.attributes=e.attributes),e!=null&&e.skillTree&&(this.skillTree=e.skillTree),e!=null&&e.skills&&(this.skills=e.skills),e!=null&&e.icon&&(this.icon=e.icon),e!=null&&e.unusableItems&&(this.unusableItems=e.unusableItems),e!=null&&e.actionBar&&(this.actionBar=e.actionBar),(e==null?void 0:e.lInverted)!==void 0&&(this.lInverted=e.lInverted),(e==null?void 0:e.rInverted)!==void 0&&(this.rInverted=e.rInverted),(e==null?void 0:e.lsInverted)!==void 0&&(this.lsInverted=e.lsInverted),(e==null?void 0:e.rsInverted)!==void 0&&(this.rsInverted=e.rsInverted),(e==null?void 0:e.pInverted)!==void 0&&(this.pInverted=e.pInverted),(e==null?void 0:e.qInverted)!==void 0&&(this.qInverted=e.qInverted),(e==null?void 0:e.fInverted)!==void 0&&(this.fInverted=e.fInverted),e!=null&&e.lWhitelist&&(this.lWhitelist=e.lWhitelist),e!=null&&e.rWhitelist&&(this.rWhitelist=e.rWhitelist),e!=null&&e.lsWhitelist&&(this.lsWhitelist=e.lsWhitelist),e!=null&&e.rsWhitelist&&(this.rsWhitelist=e.rsWhitelist),e!=null&&e.pWhitelist&&(this.pWhitelist=e.pWhitelist),e!=null&&e.qWhitelist&&(this.qWhitelist=e.qWhitelist),e!=null&&e.fWhitelist&&(this.fWhitelist=e.fWhitelist))}get parent(){return this._parent}set parent(e){this._parent=e,this.parentStr=e?e.name:""}}class uc{constructor(){f(this,"isLegacy",!1);f(this,"loadClassesFromServer",async()=>{let e;try{e=await U.getClasses()}catch{return}const t=w(this.classFolders),s=w(this.classes);e.forEach(n=>{const r=n.split("/"),o=r.pop();if(!o)return;let a,l;if(r.forEach(h=>{l=a?a.getSubfolder(h):t.find(u=>u.name===h),l||(l=new M,l.name=h,l.location="server",a&&(a.add(l),l.updateParent(a))),!a&&!t.includes(l)&&t.push(l),a=l}),s.find(h=>h.name===n))return;const c=new oe({name:o,location:"server"});l&&l.add(c),s.push(c)}),this.classes.set(s)});f(this,"removeServerClasses",()=>{const e=w(this.classes);this.classes.set(e.filter(s=>s.location!=="server")),w(this.classFolders).filter(s=>s.location==="server").forEach(s=>this.deleteClassFolder(s,n=>n.location==="server"))});f(this,"loadClassTextToArray",e=>{const t=[],s=le(e),n=Object.keys(s);let r;if(n.length==1){const o=n[0];return o==="loaded"||(r=new oe({name:o}),r.load(s[o]),t.push(r)),t}for(const o of Object.keys(s))o!="loaded"&&(r=new oe({name:o}),r.load(s[o]),t.push(r));return t});f(this,"setupClassStore",(e,t,s,n,r)=>{let o=t;{const h=localStorage.getItem(e);h&&(o=s(h),r&&r(o))}const{subscribe:a,set:l,update:c}=C(o);return{subscribe:a,set:h=>(n&&(h=n(h)),l(h)),update:c}});f(this,"classes",this.setupClassStore(localStorage.getItem("classNames")?"classNames":"classData",[],e=>localStorage.getItem("classNames")?e.split(", ").map(t=>new oe({name:t,location:"local"})).filter(t=>localStorage.getItem("sapi.class."+t.name)):(localStorage.removeItem("classData"),this.isLegacy=!0,G(this.loadClassTextToArray(e))),e=>(this.persistClasses(e),e.forEach(t=>t.updateParent(e)),G(e)),e=>e.forEach(t=>t.updateParent(e))));f(this,"getClass",e=>{for(const t of w(this.classes))if(t.name==e)return t});f(this,"classFolders",this.setupClassStore("classFolders",[],e=>{if(!e||e==="null")return[];try{return JSON.parse(e,(t,s)=>{if(s){if(/\d+/.test(t)){if(typeof s=="string")return this.getClass(s);const n=new M(s.data);return n.name=s.name,n}return s}})}catch(t){return console.error("Error loading class folders. Folder data: "+e,t),Ii("Error loading class folders. "+JSON.stringify(t)+`
Folder data: `+e),[]}},e=>{const t=JSON.stringify(e,(s,n)=>n instanceof oe||n instanceof re?n.name:s==="parent"?void 0:n);return localStorage.setItem("classFolders",t),G(e)}));f(this,"updateAllAttributes",e=>w(this.classes).forEach(t=>t.updateAttributes(e)));f(this,"isClassNameTaken",e=>!!this.getClass(e));f(this,"addClass",e=>{const t=w(this.classes);let s=t.length+1;for(;!e&&this.isClassNameTaken(e||"Class "+s);)s++;const n=new oe({name:e||"Class "+s});return t.push(n),this.classes.set(t),n.save(),n});f(this,"loadClass",async e=>{if(e.loaded)return;let t;if(e.location==="local")t=le(localStorage.getItem(`sapi.class.${e.name}`)||"");else{const n=await U.getClassYaml(e.name);if(!n)return;t=ee.parse(n)}if(t===null||Object.values(t).length==0){console.warn(`Failed to parse yaml for class ${e.name}`,localStorage.getItem(`sapi.class.${e.name}`));return}const s=Object.values(t)[0];e.load(s),e.updateParent(w(this.classes)),e.loaded=!0});f(this,"cloneClass",async e=>{e.loaded||await this.loadClass(e);const t=w(this.classes);let s=e.name+" (Copy)",n=1;for(;this.isClassNameTaken(s);)s=e.name+" (Copy "+n+")",n++;const r=new oe,o=e.serializeYaml();return r.load(o),r.name=s,t.push(r),this.classes.set(t),r.save(),r});f(this,"addClassFolder",e=>{const t=w(this.classFolders);t.includes(e)||(ue.rename(e,t),t.push(e),t.sort((s,n)=>s.name.localeCompare(n.name)),this.classFolders.set(t))});f(this,"deleteClassFolder",(e,t)=>{const s=w(this.classFolders).filter(n=>n!=e);e.data.forEach(n=>{if(n instanceof M){if(t&&t(n)){this.deleteClassFolder(n,t);return}e.parent?e.parent.add(n):(n.updateParent(),s.push(n))}else e.parent&&e.parent.add(n)}),this.classFolders.set(s)});f(this,"deleteClass",e=>{const t=w(this.classes).filter(n=>n!=e),s=w(we);this.classes.set(t),localStorage.removeItem("sapi.class."+e.name),s instanceof oe&&(t.length===0?ze(`${Je}/`):t.find(n=>n===w(we))||ze(`${Je}/class/${t[0].name}/edit`).then(()=>{}))});f(this,"refreshClasses",()=>this.classes.set(G(w(this.classes))));f(this,"refreshClassFolders",()=>{this.classFolders.set(G(w(this.classFolders))),this.refreshClasses()});f(this,"loadClassText",(e,t=!1)=>{const s=le(e);if(!s||Object.keys(s).length===0)return;const n=Object.keys(s);let r;if(n.length==1){const o=n[0];r=this.isClassNameTaken(o)?this.getClass(o):this.addClass(o),t&&(r.location="server"),r.load(s[o]),this.refreshClasses();return}for(const o of Object.keys(s))o!="loaded"&&!this.isClassNameTaken(o)&&(r=this.isClassNameTaken(o)?this.getClass(o):this.addClass(o),r.load(s[o]));this.refreshClasses()});f(this,"loadClasses",e=>{var s;const t=(s=e.target)==null?void 0:s.result;t&&this.loadClassText(t)});f(this,"persistClasses",e=>{const t=(e||w(this.classes)).filter(s=>s.location==="local");localStorage.setItem("classNames",t.map(s=>s.name).join(", "))});U.onConnect(this.loadClassesFromServer),U.onDisconnect(this.removeServerClasses),this.isLegacy&&(w(this.classes).forEach(e=>{e.location==="local"&&e.save()}),this.persistClasses())}}const z=new uc;export{zt as $,Nc as A,Oc as B,De as C,Kn as D,Lc as E,$a as F,_c as G,Mo as H,Sc as I,js as J,Ac as K,z as L,nt as M,fe as N,D as O,Ya as P,lc as Q,gt as R,Ja as S,We as T,Mc as U,Ma as V,re as W,oe as X,ie as Y,Ks as Z,xn as _,we as a,Jt as a0,Ht as a1,as as a2,ee as a3,Tc as a4,Kc as a5,Wc as a6,Yc as a7,jc as a8,Uc as a9,Dc as aa,Vc as ab,ue as ac,M as ad,Fc as ae,Cc as af,xc as ag,Ic as ah,Ls as ai,Hc as aj,kt as ak,cc as al,is as am,zc as an,Jc as ao,te as ap,xs as b,Va as c,Pc as d,ja as e,Fa as f,vc as g,F as h,U as i,pn as j,Lo as k,ci as l,Qt as m,wc as n,bc as o,le as p,Es as q,kc as r,Ui as s,Oe as t,os as u,Bc as v,Rc as w,Da as x,$c as y,qc as z};
